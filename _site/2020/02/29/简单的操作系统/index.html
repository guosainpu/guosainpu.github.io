<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="å…³äºç¨‹åºä¸è®¾è®¡ã€é»‘å®¢ä¸ç”»å®¶ | é»„ç„ï¼ŒWeb & Mobile Loverï¼ŒSoftware Engineerï¼ŒUX Designer | è¿™é‡Œæ˜¯ @Huxé»„ç„ çš„ä¸ªäººåšå®¢ï¼Œä¸ä½ ä¸€èµ·å‘ç°æ›´å¤§çš„ä¸–ç•Œã€‚">
    <meta name="keywords"  content="é»„ç„, Huxé»„ç„, Hux, é¬¼æ ˆ, huxpro, @huxpro, é»„ç„çš„åšå®¢, Hux Blog, åšå®¢, ä¸ªäººç½‘ç«™, äº’è”ç½‘, Web, JavaScript, å‰ç«¯, è®¾è®¡">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="ä»0åˆ°1æ„å»ºè®¡ç®—æœº(10/12)--ç®€å•çš„æ“ä½œç³»ç»Ÿ - ä¸€åªè‰å±¥è™«">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="ä¸Šä¸€ç¯‡æˆ‘ä»¬å®Œæˆäº†Jackçš„ç¼–è¯‘å™¨ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°åœ¨Hackä¸Šç¼–å†™Jackç¨‹åºäº†ã€‚ä½†æ˜¯ä»¥Jackç›®å‰çš„èƒ½åŠ›ï¼Œå³ä½¿æ˜¯æƒ³å®Œæˆä¸€äº›ç®€å•çš„æ“ä½œä¹Ÿè¦ç¼–å†™éå¸¸å¤æ‚çš„ä»£ç ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³è¦åœ¨å±å¹•ä¸Šè¾“å‡ºâ€œHello Workd!â€ï¼Œå°±å¿…é¡»åœ¨å±å¹•ä¸Šç‰¹å®šä½ç½®ç»˜åˆ¶ä¸Šå‡ ç™¾ä¸ªåƒç´ ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªç®€å•çš„æ“ä½œç³»ç»Ÿæ¥è®©äº‹æƒ…å˜å¾—æ›´ç®€å•ä¸€äº›ã€‚
">
    
    <meta property="article:published_time" content="2020-02-29T00:00:00Z">
    
    
    <meta property="article:author" content="guosai">
    
    
    <meta property="article:tag" content="è®¡ç®—æœºåŸºç¡€">
    
    <meta property="article:tag" content="ä»0åˆ°1æ„å»ºè®¡ç®—æœº">
    
    <meta property="article:tag" content="æ“ä½œç³»ç»Ÿ">
    
    
    <meta property="og:image" content="http://localhost:4000/img/avatar-hux-ny.jpg">
    <meta property="og:url" content="http://localhost:4000/2020/02/29/%E7%AE%80%E5%8D%95%E7%9A%84%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
    <meta property="og:site_name" content="ä¸€åªè‰å±¥è™«">
    
    <title>ä»0åˆ°1æ„å»ºè®¡ç®—æœº(10/12)--ç®€å•çš„æ“ä½œç³»ç»Ÿ - ä¸€åªè‰å±¥è™«</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2020/02/29/%E7%AE%80%E5%8D%95%E7%9A%84%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">ä¸€åªè‰å±¥è™«</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80" title="è®¡ç®—æœºåŸºç¡€">è®¡ç®—æœºåŸºç¡€</a>
                        
                        <a class="tag" href="/archive/?tag=%E4%BB%8E0%E5%88%B01%E6%9E%84%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%BA" title="ä»0åˆ°1æ„å»ºè®¡ç®—æœº">ä»0åˆ°1æ„å»ºè®¡ç®—æœº</a>
                        
                        <a class="tag" href="/archive/?tag=%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F" title="æ“ä½œç³»ç»Ÿ">æ“ä½œç³»ç»Ÿ</a>
                        
                    </div>
                    <h1>ä»0åˆ°1æ„å»ºè®¡ç®—æœº(10/12)--ç®€å•çš„æ“ä½œç³»ç»Ÿ</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by guosai on February 29, 2020</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<p>ä¸Šä¸€ç¯‡æˆ‘ä»¬å®Œæˆäº†Jackçš„ç¼–è¯‘å™¨ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°åœ¨Hackä¸Šç¼–å†™Jackç¨‹åºäº†ã€‚ä½†æ˜¯ä»¥Jackç›®å‰çš„èƒ½åŠ›ï¼Œå³ä½¿æ˜¯æƒ³å®Œæˆä¸€äº›ç®€å•çš„æ“ä½œä¹Ÿè¦ç¼–å†™éå¸¸å¤æ‚çš„ä»£ç ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³è¦åœ¨å±å¹•ä¸Šè¾“å‡ºâ€œHello Workd!â€ï¼Œå°±å¿…é¡»åœ¨å±å¹•ä¸Šç‰¹å®šä½ç½®ç»˜åˆ¶ä¸Šå‡ ç™¾ä¸ªåƒç´ ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªç®€å•çš„æ“ä½œç³»ç»Ÿæ¥è®©äº‹æƒ…å˜å¾—æ›´ç®€å•ä¸€äº›ã€‚</p>

<p>æ“ä½œç³»ç»Ÿå°±æ˜¯ç”¨æ¥è¡”æ¥è®¡ç®—æœºçš„ç¡¬ä»¶ç³»ç»Ÿå’Œè½¯ä»¶ç³»ç»Ÿçš„ï¼Œä»¥ä½¿å¾—è®¡ç®—æœºå¯¹ç¨‹åºå‘˜å’Œç”¨æˆ·è€Œè¨€æ›´å®¹æ˜“ä½¿ç”¨ã€‚æœ¬ç¯‡çš„æ“ä½œç³»ç»ŸåŒ…å«äº†ä¸€ä¸ªæœ€å°è§„æ¨¡çš„æ“ä½œç³»ç»Ÿï¼ˆå…¶å®å°±æ˜¯ä¸€ä¸ªJackæ ‡å‡†åº“çš„é›†åˆï¼‰ï¼Œä¸»è¦åŒ…æ‹¬ï¼šæ•°å­¦è¿ç®—ã€å­—ç¬¦ä¸²æ“ä½œã€å†…å­˜ç®¡ç†ã€æ–‡æœ¬å’Œå›¾å½¢è¾“å‡ºåˆ°å±å¹•ã€é”®ç›˜è¾“å…¥å¤„ç†ç­‰åŠŸèƒ½ï¼Œä¸åŒ…æ‹¬ï¼šè¿›ç¨‹ç®¡ç†ã€ç£ç›˜ç®¡ç†ã€é€šä¿¡ç­‰åŠŸèƒ½ã€‚</p>

<h3 id="æ•°å­¦æ“ä½œ">æ•°å­¦æ“ä½œ</h3>

<p>ç›®å‰Hackåœ¨ç¡¬ä»¶ä¸Šåªæ”¯æŒåŠ æ³•å’Œå‡æ³•ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨è½¯ä»¶å±‚é¢å®Œå–„Hackçš„æ•°å­¦æ“ä½œï¼ŒåŒ…æ‹¬ï¼šä¹˜æ³•ã€é™¤æ³•ã€ç»å¯¹å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¼€å¹³æ–¹æ“ä½œã€‚</p>

<p><strong>æ•ˆç‡ç¬¬ä¸€</strong>ï¼Œåœ¨åŠ å‡æ³•çš„åŸºç¡€ä¸Šå®ç°è¿™äº›æ•°å­¦æ“ä½œçš„æ–¹å¼å¯èƒ½æœ‰å¾ˆå¤šï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æœ€åº”è¯¥å…³æ³¨çš„æ˜¯æ‰§è¡Œçš„æ•ˆç‡ï¼Œå› ä¸ºæ•°å­¦æ“ä½œæ˜¯è®¡ç®—æœºå·¥ä½œæ—¶æœ€å¸¸åšçš„åŸºæœ¬æ“ä½œä¹‹ä¸€ï¼Œæœ€å¤§ç¨‹åº¦çš„ä¼˜åŒ–æ•°å­¦æ“ä½œæ˜¯ä¼˜åŒ–è®¡ç®—æœºæ€§èƒ½çš„é‡è¦ä¸»é¢˜ã€‚ä¾‹å¦‚CPUä¼šä¸“é—¨ä¸ºæµ®ç‚¹æ•°è®¾è®¡æµ®ç‚¹æ•°è®¡ç®—å•å…ƒï¼Œæ›´æ“…é•¿æ•°å­¦è¿ç®—çš„GPUä¹Ÿè¢«è®¾è®¡å‡ºæ¥ç”¨äºè¾…åŠ©è®¡ç®—æœºçš„æ•°å­¦è¿ç®—ã€‚</p>

<h4 id="ä¹˜æ³•">ä¹˜æ³•</h4>

<p>å¯¹äºä¹˜æ³• sum=x*yï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯æŠŠ sum=sum+x é‡å¤è¿ç®— y æ¬¡ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚å¦ä¸€ç§æ–¹å¼æ˜¯æ¨¡æ‹Ÿå°å­¦è¿ç®—ä¹˜æ³•çš„ç«–å¼æ–¹å¼ï¼šç”¨ shiftedx å»ä¹˜ y çš„æ¯ä¸€ä½ï¼Œå¦‚æœ y çš„è¿™ä½ä¸º1ï¼Œåˆ™æŠŠç»“æœåŠ åˆ° sum ä¸­ï¼Œå¦‚æœä¸º0åˆ™èˆå¼ƒï¼›å¤„ç†å®Œ y çš„å½“å‰ä½åï¼Œå¤„ç† y çš„ä¸‹ä¸€ä½ï¼Œæ­¤æ—¶éœ€è¦æ“ä½œ shiftedx=shiftedx*2ï¼ˆæ­¤æ“ä½œå¯ä»¥é€šè¿‡åŠ æ³•å®ç°ï¼Œæˆ–è€…é€šè¿‡ç§»ä½å®ç°ï¼Œç§»ä½æ•ˆç‡æ›´é«˜ï¼Œè™½ç„¶Hackä¸æ”¯æŒç§»ä½æ“ä½œï¼‰ã€‚ç¬¬äºŒç§æ–¹å¼æ•ˆç‡æ›´é«˜ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(log2(n))ã€‚</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcq3caoxlhj30ra09mq2w.jpg" width="500" /></center>
<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcq2u7z2gtj31220bijrp.jpg" width="600" /></center>

<p>å®ç°ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="kd">static</span> <span class="kt">int</span> <span class="n">powers_of_two</span><span class="o">;</span>

<span class="n">function</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">let</span> <span class="n">powers_of_two</span> <span class="o">=</span> <span class="nc">Array</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="mi">16</span><span class="o">);</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="mi">8</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span> <span class="o">=</span> <span class="mi">32</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span> <span class="o">=</span> <span class="mi">64</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span> <span class="o">=</span> <span class="mi">128</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span> <span class="o">=</span> <span class="mi">256</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">9</span><span class="o">]</span> <span class="o">=</span> <span class="mi">512</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">10</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">11</span><span class="o">]</span> <span class="o">=</span> <span class="mi">2048</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">12</span><span class="o">]</span> <span class="o">=</span> <span class="mi">4096</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">13</span><span class="o">]</span> <span class="o">=</span> <span class="mi">8192</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">14</span><span class="o">]</span> <span class="o">=</span> <span class="mi">16384</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="mi">15</span><span class="o">]</span> <span class="o">=</span> <span class="mi">16384</span><span class="o">+</span><span class="mi">16384</span><span class="o">;</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// åˆ¤æ–­xçš„ç¬¬nä½æ˜¯å¦ä¸º1</span>
<span class="n">function</span> <span class="kt">boolean</span> <span class="nf">bit</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">~((</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="n">n</span><span class="o">])</span> <span class="o">=</span> <span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">function</span> <span class="kt">int</span> <span class="nf">multiply</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">sum</span><span class="o">,</span> <span class="n">shiftedX</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">j</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">shiftedX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">16</span> <span class="o">)</span> <span class="o">{</span>   <span class="c1">// 16-bit numbers</span>
        <span class="k">if</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">bit</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="n">j</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">shiftedX</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">let</span> <span class="n">shiftedX</span> <span class="o">=</span> <span class="n">shiftedX</span> <span class="o">+</span> <span class="n">shiftedX</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="é™¤æ³•">é™¤æ³•</h4>

<p>å¯¹äºé™¤æ³• d=x/yï¼Œå®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•æ˜¯é‡å¤è®¡ç®— x=x-yï¼Œæ¯è®¡ç®—ä¸€æ¬¡å d=d+1ï¼Œç›´è‡³ x-y&lt;0 ä¸ºæ­¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€åçš„æƒ…å†µæ˜¯ y=1 çš„æƒ…å†µï¼Œæ­¤æ—¶çš„æ­¥é•¿æœ€çŸ­ï¼Œéœ€è¦é‡å¤è®¡ç®—xæ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(x)ã€‚æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå¢åŠ æ­¥é•¿ï¼Œæ¯æ¬¡ä¸æ˜¯å‡å»yï¼Œè€Œæ˜¯å‡å»2yï¼Œè€Œä¸”æ˜¯é€’å½’çš„è¿›è¡Œä¸‹å»ï¼Œç›´è‡³ x&lt;y æ—¶è¿”å›ï¼Œæ­¤æ—¶æœ€åçš„æ—¶é—´å¤æ‚åº¦ä¸º O(log2(n))ã€‚</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcq7h7f8ezj311m0bk3yt.jpg" width="600" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">int</span> <span class="nf">divide</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">neg_x</span><span class="o">,</span> <span class="n">neg_y</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">q</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">result</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">neg_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">neg_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
    <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">y</span><span class="o">);</span>

    <span class="k">if</span><span class="o">(</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">x</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">let</span> <span class="n">q</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">+</span><span class="n">y</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">x</span><span class="o">-(</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">y</span><span class="o">)</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">result</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="n">q</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">result</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="k">if</span><span class="o">(</span> <span class="n">neg_x</span> <span class="o">=</span> <span class="n">neg_y</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="å¼€å¹³æ–¹">å¼€å¹³æ–¹</h4>

<p>è¿™ä¸ªå¼€å¹³æ–¹å‡½æ•°è¿”å›å…¥å‚ x å¼€å¹³æ–¹åç»“æœçš„æ•´æ•°éƒ¨åˆ†ã€‚ç®—æ³•å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼ï¼Œæ‰¾åˆ° $y^2\leq x&lt;(y+1)^2$ å³å¯ã€‚è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log2(n))ï¼Œä½†ç”±äºæˆ‘ä»¬è®¡ç®—çš„ x å¤§å°æœ‰ä¸Šé™ï¼ˆ$2^{16}-1$ï¼‰ï¼Œæ‰€ä»¥çœŸå®æ‰§è¡Œæ—¶å¾ªç¯çš„æ¬¡æ•°æ˜¯å›ºå®šçš„ n/2 (n=16)ï¼Œå¤æ‚åº¦æ˜¯O(n/2)ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="n">ä¼ªä»£ç </span><span class="err">ï¼š</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">...</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span> <span class="k">do</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="o">^</span><span class="n">j</span><span class="o">)^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="n">then</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">j</span>
<span class="k">return</span> <span class="n">y</span>

<span class="n">function</span> <span class="kt">int</span> <span class="nf">sqrt</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">j</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">approx</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">approx_squared</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>      <span class="c1">// = #bits / 2 - 1</span>
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">approx</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">powers_of_two</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
        <span class="n">let</span> <span class="n">approx_squared</span> <span class="o">=</span> <span class="n">approx</span> <span class="o">*</span> <span class="n">approx</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="o">~(</span><span class="n">approx_squared</span> <span class="o">&gt;</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">approx_squared</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>    <span class="c1">// in case of overflow</span>
            <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="n">approx</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">let</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">y</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="ç»å¯¹å€¼æœ€å¤§å€¼æœ€å°å€¼å–æ¨¡">ç»å¯¹å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€å–æ¨¡</h4>

<p>è¿™äº›è¿ç®—å°±æ¯”è¾ƒç®€å•äº†</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">int</span> <span class="nf">max</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">function</span> <span class="kt">int</span> <span class="nf">min</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">function</span> <span class="kt">int</span> <span class="nf">abs</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">function</span> <span class="kt">int</span> <span class="nf">mod</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">q</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">q</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="o">(</span><span class="n">q</span><span class="o">*</span><span class="n">y</span><span class="o">);</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</h3>

<p>å­—ç¬¦ä¸²çš„é€»è¾‘æ¯”è¾ƒç®€å•ã€‚åœ¨Jackä¸­ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå­˜å‚¨å†…å®¹ä¸€ä¸²asciiç¼–ç ï¼ˆä¸”ä¸éœ€è¦ä»¥\0ç»“å°¾ï¼‰ã€‚æˆ‘ä»¬ç”¨Stringç±»æ¥å®ç°ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªæ–¹æ³•æ˜¯æ„é€ å‡½æ•° new(int length) å’Œ appendChar(char c)ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ”¯æŒä¸€ä¸ªä¸€ä¸ªåœ°è¿½åŠ å­—ç¬¦ï¼Œä¸æ”¯æŒç›´æ¥ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ğŸ˜‚ã€‚é™„ä¸Š<a href="https://zh.wikipedia.org/wiki/ASCII">asciiç¼–ç è¡¨ï¼š</a></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">String</span> <span class="o">{</span>
    <span class="n">field</span> <span class="nc">Array</span> <span class="n">buffer</span><span class="o">;</span>
    <span class="n">field</span> <span class="kt">int</span> <span class="n">buffer_len</span><span class="o">;</span>
    <span class="n">field</span> <span class="kt">int</span> <span class="n">str_len</span><span class="o">;</span>
    
    <span class="n">constructor</span> <span class="nc">String</span> <span class="nf">new</span><span class="o">(</span><span class="kt">int</span> <span class="n">maxLength</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">maxLength</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">maxLength</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">let</span> <span class="n">buffer</span> <span class="o">=</span> <span class="nc">Array</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="n">maxLength</span><span class="o">);</span>
        <span class="n">let</span> <span class="n">buffer_len</span> <span class="o">=</span> <span class="n">maxLength</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">str_len</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Array</span><span class="o">.</span><span class="na">dispose</span><span class="o">(</span><span class="n">buffer</span><span class="o">);</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">int</span> <span class="nf">length</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">str_len</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">char</span> <span class="nf">charAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">buffer</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">setCharAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">,</span> <span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">buffer</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

     <span class="o">*</span>  <span class="nc">Returns</span> <span class="k">this</span> <span class="n">string</span> <span class="n">as</span> <span class="n">the</span> <span class="k">return</span> <span class="n">value</span><span class="o">.</span> <span class="o">*/</span>
    <span class="n">method</span> <span class="nc">String</span> <span class="nf">appendChar</span><span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">str_len</span> <span class="o">&lt;</span> <span class="n">buffer_len</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">buffer</span><span class="o">[</span><span class="n">str_len</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">str_len</span> <span class="o">=</span> <span class="n">str_len</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">eraseLastChar</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">str_len</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">str_len</span> <span class="o">=</span> <span class="n">str_len</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** è¿”å›å­—ç¬¦ä¸²ä»£è¡¨çš„æ•´æ•°å€¼ */</span>
    <span class="n">method</span> <span class="kt">int</span> <span class="nf">intValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">int_val</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">boolean</span> <span class="n">neg</span><span class="o">;</span>
        
        <span class="n">let</span> <span class="n">int_val</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="o">(</span><span class="n">str_len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">buffer</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">45</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>      <span class="c1">// '-'</span>
            <span class="n">let</span> <span class="n">neg</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">neg</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="k">while</span><span class="o">(</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">str_len</span><span class="o">)</span> <span class="o">&amp;</span> <span class="nc">String</span><span class="o">.</span><span class="na">is_digit</span><span class="o">(</span><span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">int_val</span> <span class="o">=</span> <span class="o">(</span><span class="n">int_val</span> <span class="o">*</span> <span class="mi">10</span><span class="o">)</span> <span class="o">+</span> <span class="nc">String</span><span class="o">.</span><span class="na">digit_val</span><span class="o">(</span><span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
            <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="n">neg</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">int_val</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">int_val</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="n">function</span> <span class="kt">boolean</span> <span class="nf">is_digit</span><span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">~(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">48</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">~(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">57</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="n">function</span> <span class="kt">int</span> <span class="nf">digit_val</span><span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">48</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="n">function</span> <span class="kt">char</span> <span class="nf">digit_char</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¿å­˜æ•´æ•° */</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">setInt</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">str_len</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>    <span class="c1">// Clear string</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="n">number</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">number</span> <span class="o">=</span> <span class="o">-</span><span class="n">number</span><span class="o">;</span>
            <span class="k">do</span> <span class="nf">appendChar</span><span class="o">(</span><span class="mi">45</span><span class="o">);</span>      <span class="c1">// leading '-'</span>
        <span class="o">}</span>
        
        <span class="k">do</span> <span class="nf">do_set_int</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">do_set_int</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">q</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">mod</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">char</span> <span class="n">c</span><span class="o">;</span>
        
        <span class="n">let</span> <span class="n">q</span> <span class="o">=</span> <span class="n">number</span> <span class="o">/</span> <span class="mi">10</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">mod</span> <span class="o">=</span> <span class="n">number</span> <span class="o">-</span> <span class="o">(</span><span class="n">q</span><span class="o">*</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">let</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">digit_char</span><span class="o">(</span><span class="n">mod</span><span class="o">);</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="n">number</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">do</span> <span class="nf">appendChar</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">do</span> <span class="nf">do_set_int</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
            <span class="k">do</span> <span class="nf">appendChar</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="n">function</span> <span class="kt">char</span> <span class="nf">newLine</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">128</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">function</span> <span class="kt">char</span> <span class="nf">backSpace</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">129</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** åŒå¼•å· */</span>
    <span class="n">function</span> <span class="kt">char</span> <span class="nf">doubleQuote</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">34</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="å†…å­˜ç®¡ç†">å†…å­˜ç®¡ç†</h3>

<p>ä½¿ç”¨é«˜çº§è¯­è¨€ï¼Œæœ€å¤§çš„æ–¹ä¾¿ä¹‹ä¸€å°±æ˜¯å¼€å‘è€…å‡ ä¹ä¸ç”¨å…³æ³¨å†…å­˜ç®¡ç†çš„ç»†èŠ‚ï¼Œæ‰€æœ‰å¤æ‚çç¢çš„å·¥ä½œéƒ½åˆæ“ä½œç³»ç»Ÿï¼Œç¼–è¯‘å™¨ï¼Œè™šæ‹Ÿæœºï¼Œæ±‡ç¼–å™¨ç­‰åº•å±‚æ¥è´Ÿè´£å®ç°ã€‚ä¸åŒå˜é‡ç±»å‹çš„å†…å­˜åœ¨ç¨‹åºå£°æ˜å‘¨æœŸä¸­çš„ä¸åŒæ—¶åˆ»è¢«åˆ†é…ï¼Œä¾‹å¦‚ï¼Œé™æ€å˜é‡åœ¨ç¼–è¯‘æœŸç”±ç¼–è¯‘å™¨ä¸ºå…¶åˆ†é…å†…å­˜ï¼›å±€éƒ¨å˜é‡åˆ™åœ¨æ¯ä¸ªå‡½æ•°è¿è¡Œçš„æ—¶å€™åˆ†é…åœ¨æ ˆå†…å­˜ä¸Šï¼›å…¶ä»–å†…å­˜åˆ™æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶è¢«åŠ¨æ€åœ°åˆ†é…åœ¨å †å†…å­˜ä¸Šï¼Œè¿™äº›å†…å­˜å°±éœ€è¦å€ŸåŠ©æ“ä½œç³»ç»Ÿæ¥ç®¡ç†äº†ã€‚æ“ä½œç³»ç»Ÿå¯èƒ½ä½¿ç”¨ä¸åŒçš„æ–¹å¼æ¥ç®¡ç†å†…å­˜çš„åˆ†é…å’Œå›æ”¶ï¼Œé€šå¸¸éƒ½æ˜¯ç”¨alloc()å’ŒdeAlloc()è¿™ä¸¤ä¸ªå‡½æ•°ä¸­å®ç°çš„ã€‚</p>

<h4 id="æœ€ç®€å•çš„å†…å­˜ç®¡ç†ç®—æ³•">æœ€ç®€å•çš„å†…å­˜ç®¡ç†ç®—æ³•</h4>

<p>ä½¿ç”¨ä¸€ä¸ªå•ä¸€çš„æŒ‡é’ˆ free æŒ‡å‘è¿˜æœªä½¿ç”¨è¿‡çš„å†…å­˜çš„åŸºåœ°å€ã€‚è¿™ç§æ–¹å¼åªæ˜¯ç®€å•çš„å‘å‰åˆ†é…å†…å­˜ï¼Œä¸è´Ÿè´£å›æ”¶å†…å­˜ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">// ä¼ªä»£ç </span>
<span class="n">initialize</span> <span class="n">free</span> <span class="o">=</span> <span class="n">heapBase</span>

<span class="c1">// åˆ†é…ä¸€å—å¤§å°ä¸º size çš„å†…å­˜</span>
<span class="n">alloc</span><span class="o">(</span><span class="n">size</span><span class="o">)</span>
  <span class="n">pointer</span> <span class="o">=</span> <span class="n">free</span>
  <span class="n">free</span> <span class="o">=</span> <span class="n">free</span> <span class="o">+</span> <span class="n">size</span> 
  <span class="k">return</span> <span class="n">pointer</span>

<span class="c1">// å›æ”¶objectçš„å†…å­˜</span>
<span class="n">deAlloc</span><span class="o">(</span><span class="n">object</span><span class="o">)</span>
<span class="k">do</span> <span class="n">nothing</span>        <span class="c1">// ä¸åšå†…å­˜å›æ”¶å¤„ç†</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="ç®—æ³•æ”¹è¿›">ç®—æ³•æ”¹è¿›</h4>

<p>ç»å…¸çš„ç®—æ³•æ˜¯å¯ä»¥ä½¿ç”¨é“¾è¡¨æ¥ç®¡ç†å†…å­˜ã€‚è¯¥ç®—æ³•ç®¡ç†ä¸€ä¸ªfreeListé“¾è¡¨ï¼Œé“¾è¡¨çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªå†…å­˜æ®µï¼Œè°ƒç”¨è€…ç”³è¯·åˆ†é…å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿä»å¯ç”¨å†…å­˜æ®µä¸­æŒ‘é€‰ä¸€ä¸ªåˆé€‚çš„å†…å­˜æ®µï¼ˆå†…å­˜æ®µå†…å­˜å¤§äºç”³è¯·çš„å†…å­˜ï¼‰ï¼Œå°†å…¶ï¼ˆå†…å­˜æ®µçš„å…¨éƒ¨å†…å­˜æˆ–éƒ¨åˆ†å†…å­˜ï¼‰è¿”å›ç»™è°ƒç”¨è€…ï¼Œç„¶åæ›´æ–°é“¾è¡¨ã€‚è°ƒç”¨è€…ç”³è¯·å›æ”¶å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»ŸæŠŠéœ€è¦å›æ”¶çš„è¿™æ®µå†…å­˜åŠ å…¥freeListé“¾è¡¨ã€‚</p>

<p>æ¯ä¸ªå†…å­˜æ®µçš„ç¬¬ä¸€ä¸ªä½ç½®ç”¨äºä¿å­˜è¯¥å†…å­˜æ®µçš„é•¿åº¦ï¼Œç¬¬äºŒä¸ªä½ç½®ç”¨äºæŒ‡å‘ Next å†…å­˜æ®µã€‚å½“æ“ä½œç³»ç»ŸæŸ¥æ‰¾åˆé€‚çš„å†…å­˜æ®µæ—¶å¯ä»¥ä½¿ç”¨<strong>æœ€ä¼˜é€‚åº”ç®—æ³•</strong>ï¼Œå³æŸ¥æ‰¾æ•´ä¸ªé“¾è¡¨ä¸­å¤§å°æœ€åŒ¹é…å˜é‡çš„å†…å­˜æ®µï¼›æˆ–è€…<strong>æœ€å…ˆé€‚åº”ç®—æ³•</strong>ï¼Œå³æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³å˜é‡éœ€æ±‚çš„å†…å­˜æ®µã€‚</p>

<p>æˆ‘ä»¬ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œå½“å‰çš„freeListçŠ¶æ€å¦‚å·¦å›¾æ‰€ç¤ºï¼Œæœ‰ä¸‰å—å†…å­˜ï¼Œå…¶å†…å­˜æ®µå¤§å°åˆ†åˆ«æ˜¯4ã€9ã€5ï¼ˆå¯ç”¨å¤§å°æ˜¯2ã€7ã€3ï¼‰ã€‚å½“è°ƒç”¨è€…æ‰§è¡Œalloc(5)æ—¶ï¼Œä»£è¡¨è°ƒç”¨è€…éœ€è¦å¤§å°ä¸º5çš„å†…å­˜ï¼Œæ­¤æ—¶ä¸‰å—å†…å­˜ä¸­åªæœ‰å¤§å°ä¸º9çš„å†…å­˜å—æ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬ä¸­å–å‡ºå6ä½å†…å­˜è¿”å›ç»™è°ƒç”¨è€…ï¼ˆå¤šçš„ä¸€ä½ç”¨æ¥æ ‡è¯†è¯¥å˜é‡å ç”¨å†…å­˜å¤§å°ï¼Œåç»­ç”¨äºå†…å­˜å›æ”¶æ—¶ä½¿ç”¨ï¼‰ï¼Œç„¶åå¤§å°ä¸º9çš„å†…å­˜å—å°±è¿˜å‰©3äº†ã€‚</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcuxvnsui0j31dq0lq0t3.jpg" width="700" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="c1">// ä¼ªä»£ç </span>
<span class="nl">Initialize:</span>
	<span class="n">freeList</span> <span class="o">=</span> <span class="n">heap</span>
	<span class="n">freeList</span><span class="o">.</span><span class="na">length</span> <span class="o">=</span> <span class="n">heapLength</span>
	<span class="n">freeList</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span>

<span class="c1">// åˆ†é…å†…å­˜</span>
<span class="n">alloc</span><span class="o">(</span><span class="n">size</span><span class="o">):</span>
	<span class="n">åˆ©ç”¨</span><span class="err">â€œ</span><span class="n">æœ€ä¼˜é€‚åº”ç®—æ³•</span><span class="err">â€</span><span class="n">æˆ–è€…</span><span class="err">â€œ</span><span class="n">æœ€å…ˆé€‚åº”ç®—æ³•</span><span class="err">â€</span><span class="n">æ‰¾åˆ°åˆé€‚çš„å†…å­˜æ®µ</span><span class="err">ï¼ˆ</span><span class="n">æ»¡è¶³æ¡ä»¶</span> <span class="n">segement</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">size</span><span class="err">ï¼‰</span>
	<span class="k">if</span> <span class="n">æ‰¾ä¸åˆ°</span>
	  <span class="n">è¿”å›</span> <span class="n">fail</span> <span class="n">æˆ–è€…å°è¯•æ•´åˆå†…å­˜ç¢ç‰‡</span>
	<span class="k">else</span>
	  <span class="n">block</span> <span class="o">=</span> <span class="n">ä»å†…å­˜æ®µä¸­å–å‡ºä¸€æ®µå†…å­˜</span><span class="err">ï¼Œ</span><span class="n">å¤§å°ä¸º</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="err">ï¼ˆ</span><span class="n">å¦‚æœå–å‡ºå</span><span class="err">ï¼Œ</span><span class="n">è¯¥å†…å­˜æ®µå‰©ä½™å¤ªå°</span><span class="err">ï¼Œ</span><span class="n">åˆ™ç›´æ¥æ˜¯è¿™æ•´ä¸ªå†…å­˜æ®µå°±å¥½</span><span class="err">ï¼Œ</span><span class="n">é˜²æ­¢å°ç¢ç‰‡å‡ºç°</span><span class="err">ï¼‰</span>
	  <span class="n">æ›´æ–°é€‰ä¸­çš„å†…å­˜çš„å‰©ä½™æƒ…å†µ</span>
	  <span class="n">block</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="err">ï¼Œ</span><span class="n">æ ‡è¯†å˜é‡ç”³è¯·çš„å ç”¨å†…å­˜å¤§å°</span><span class="err">ï¼Œ</span><span class="n">åç»­ç”¨äºå†…å­˜å›æ”¶æ—¶ä½¿ç”¨</span>
	  <span class="k">return</span> <span class="n">block</span>

<span class="c1">// å›æ”¶å†…å­˜</span>
<span class="n">deAlloc</span><span class="o">(</span><span class="n">object</span><span class="o">)</span>
	<span class="n">segement</span> <span class="o">=</span> <span class="n">object</span> <span class="o">-</span> <span class="mi">1</span><span class="err">ï¼Œ</span><span class="n">è¯¥æ®µå†…å­˜çš„åŸºåœ°å€</span>
	<span class="n">segement</span><span class="o">.</span><span class="na">length</span> <span class="o">=</span> <span class="n">object</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span><span class="err">ï¼Œ</span><span class="n">å˜é‡å ç”¨å†…å­˜çš„å¤§å°</span>
	<span class="n">å°†segementæ’å…¥freeList</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
</pre></td><td class="rouge-code"><pre><span class="c1">// ç”¨jackå®ç°</span>
<span class="kd">class</span> <span class="nc">Memory</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="nc">Array</span> <span class="n">memory</span><span class="o">;</span>
    <span class="kd">static</span> <span class="nc">Array</span> <span class="n">freeList</span><span class="o">;</span>
    <span class="kd">static</span> <span class="nc">Array</span> <span class="no">NO_BLOCK</span><span class="o">;</span>
    
    <span class="kd">static</span> <span class="kt">int</span> <span class="no">FL_LENGTH</span><span class="o">;</span>  <span class="c1">// freeListé•¿åº¦åœ¨segementä¸Šçš„indexï¼Œå€¼ä¸ºä¸º0</span>
    <span class="kd">static</span> <span class="kt">int</span> <span class="no">FL_NEXT</span><span class="o">;</span>    <span class="c1">// freeListnextæŒ‡é’ˆåœ¨segementä¸Šçš„ndexï¼Œå€¼ä¸ºä¸º1</span>
    <span class="kd">static</span> <span class="kt">int</span> <span class="no">ALLOC_SIZE</span><span class="o">;</span> <span class="c1">// åˆ†é…çš„blockçš„sizeï¼Œåœ¨blockä¸Šçš„indexï¼Œå€¼ä¸º-1</span>
    
    <span class="cm">/** åˆå§‹åŒ– */</span>
    <span class="n">function</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">memory</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">freeList</span> <span class="o">=</span> <span class="mi">2048</span><span class="o">;</span>    <span class="c1">// heapåŸºåœ°å€</span>
        <span class="n">let</span> <span class="no">NO_BLOCK</span> <span class="o">=</span> <span class="mi">16384</span><span class="o">;</span>   
        <span class="n">let</span> <span class="no">FL_LENGTH</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">let</span> <span class="no">FL_NEXT</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">let</span> <span class="no">ALLOC_SIZE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">freeList</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">=</span> <span class="mi">16384</span><span class="o">-</span><span class="mi">2048</span><span class="o">;</span>   <span class="c1">//åˆå§‹åŒ–freeListï¼Œæ­¤æ—¶freeçš„å†…å­˜ä¸ºæ•´ä¸ªheap</span>
        <span class="n">let</span> <span class="n">freeList</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** è¿”å›åœ°å€ä¸ºaddressçš„å†…å­˜å•å…ƒçš„å†…å®¹ */</span>
    <span class="n">function</span> <span class="kt">int</span> <span class="nf">peek</span><span class="o">(</span><span class="kt">int</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">memory</span><span class="o">[</span><span class="n">address</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="cm">/** æŠŠæ•°å€¼valueå­˜å‚¨åˆ°åœ°å€ä¸ºaddressçš„å†…å­˜å•å…ƒä¸­ */</span>
    <span class="n">function</span> <span class="kt">void</span> <span class="nf">poke</span><span class="o">(</span><span class="kt">int</span> <span class="n">address</span><span class="o">,</span> <span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">memory</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** ä»å¯ç”¨å†…å­˜ä¸­å¯»æ‰¾ä¸€å—åˆé€‚çš„å†…å­˜å—ï¼Œè¿”å›å†…å­˜å—çš„åŸºåœ°å€ */</span>
    <span class="n">function</span> <span class="nc">Array</span> <span class="nf">alloc</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">prev_block</span><span class="o">;</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">found_block</span><span class="o">;</span>
        
        <span class="n">let</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">best_fit</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>   <span class="c1">// prev_block æ˜¯ç›®æ ‡ block çš„å‰ä¸€ä¸ªblock</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="no">NO_BLOCK</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">found_block</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>               <span class="c1">// æœªæ‰¾åˆ°</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
                <span class="n">let</span> <span class="n">found_block</span> <span class="o">=</span> <span class="n">freeList</span><span class="o">;</span>       <span class="c1">// ç›®æ ‡ block æ˜¯ freeList çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span>
                <span class="n">let</span> <span class="n">freeList</span> <span class="o">=</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">do_alloc</span><span class="o">(</span><span class="n">found_block</span><span class="o">,</span> <span class="n">size</span><span class="o">);</span> <span class="c1">// åˆ†é…å†…å­˜ï¼Œå¹¶æ›´æ–°freeList</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="n">let</span> <span class="n">found_block</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
                <span class="n">let</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">do_alloc</span><span class="o">(</span><span class="n">found_block</span><span class="o">,</span> <span class="n">size</span><span class="o">);</span> <span class="c1">// åˆ†é…å†…å­˜ï¼Œå¹¶æ›´æ–°freeList</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">found_block</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="cm">/** æœ€ä¼˜åŒ¹é…ç®—æ³• */</span>
    <span class="n">function</span> <span class="nc">Array</span> <span class="nf">best_fit</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">best_block</span><span class="o">;</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">prev_block</span><span class="o">;</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">cur_block</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">best_size</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">cur_size</span><span class="o">;</span>
        
        <span class="n">let</span> <span class="n">best_block</span> <span class="o">=</span> <span class="no">NO_BLOCK</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">best_size</span> <span class="o">=</span> <span class="mi">16384</span> <span class="o">-</span> <span class="mi">2048</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">cur_block</span> <span class="o">=</span> <span class="n">freeList</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        
        <span class="c1">// éå†freeListï¼Œæ‰¾åˆ°å¯ç”¨å†…å­˜å¤§äºsieï¼Œä¸”å…¶ä¸­æœ€å°çš„block</span>
        <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">cur_block</span> <span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">cur_size</span> <span class="o">=</span> <span class="n">cur_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]-</span><span class="mi">1</span><span class="o">;</span>
            <span class="k">if</span><span class="o">(</span> <span class="o">~(</span><span class="n">cur_size</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">cur_size</span> <span class="o">&lt;</span> <span class="n">best_size</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
                <span class="n">let</span> <span class="n">best_block</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">;</span>
                <span class="n">let</span> <span class="n">best_size</span> <span class="o">=</span> <span class="n">cur_size</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">let</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="n">cur_block</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">cur_block</span> <span class="o">=</span> <span class="n">cur_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="n">best_block</span><span class="o">;</span>  <span class="c1">// è¿”å›æœ€ä¼˜blockçš„å‰ä¸€ä¸ªblock</span>
    <span class="o">}</span>

    <span class="cm">/** åˆ†é…å†…å­˜ï¼Œå¹¶å¡«å……block headerçš„å€¼ï¼ˆå€¼ä¸ºblockçš„é•¿åº¦ï¼‰*/</span>
    <span class="n">function</span> <span class="nc">Array</span> <span class="nf">do_alloc</span><span class="o">(</span><span class="nc">Array</span> <span class="n">found_block</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">next_block</span><span class="o">;</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">block_size</span><span class="o">;</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="n">found_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">&gt;</span> <span class="o">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>          <span class="c1">// blockå†…å­˜å¤§äºç”³è¯·å†…å†…å­˜ï¼Œåˆ†é…blockçš„ä¸€éƒ¨åˆ†</span>
            <span class="n">let</span> <span class="n">next_block</span> <span class="o">=</span> <span class="n">found_block</span> <span class="o">+</span> <span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span>           <span class="c1">// next_blockçš„ä½ç½®</span>
            <span class="n">let</span> <span class="n">next_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="n">found_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>  <span class="c1">// next_blocké‡ç½®blockä¿¡æ¯</span>
            <span class="n">let</span> <span class="n">next_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">=</span> <span class="n">found_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">-</span> <span class="o">(</span><span class="n">next_block</span> <span class="o">-</span> <span class="n">found_block</span><span class="o">);</span>
            <span class="n">let</span> <span class="n">found_block</span> <span class="o">=</span> <span class="n">found_block</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>               <span class="c1">// found_blocké‡ç½®blockä¿¡æ¯</span>
            <span class="n">let</span> <span class="n">found_block</span><span class="o">[</span><span class="no">ALLOC_SIZE</span><span class="o">]</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span>            
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>                                               <span class="c1">// æŠŠæ•´å—å†…å­˜éƒ½åˆ†é…ç»™ç”³è¯·è€…</span>
            <span class="n">let</span> <span class="n">next_block</span> <span class="o">=</span> <span class="n">found_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
            <span class="n">let</span> <span class="n">block_size</span> <span class="o">=</span> <span class="n">found_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">];</span>
            <span class="n">let</span> <span class="n">found_block</span> <span class="o">=</span> <span class="n">found_block</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>               <span class="c1">// found_blocké‡ç½®blockä¿¡æ¯</span>
            <span class="n">let</span> <span class="n">found_block</span><span class="o">[</span><span class="no">ALLOC_SIZE</span><span class="o">]</span> <span class="o">=</span> <span class="n">block_size</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="n">next_block</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** é‡Šæ”¾å†…å­˜ */</span>
    <span class="n">function</span> <span class="kt">void</span> <span class="nf">deAlloc</span><span class="o">(</span><span class="nc">Array</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">alloc_size</span><span class="o">;</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">prev_block</span><span class="o">;</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">next_block</span><span class="o">;</span>
        
        <span class="n">let</span> <span class="n">alloc_size</span> <span class="o">=</span> <span class="n">object</span><span class="o">[</span><span class="no">ALLOC_SIZE</span><span class="o">];</span>
        <span class="n">let</span> <span class="n">object</span> <span class="o">=</span> <span class="n">object</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>        
        <span class="n">let</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">find_prev_free</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>     <span class="c1">// æ‰¾åˆ°prev_block</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>                           <span class="c1">// objectæˆä¸ºæ–°çš„é¦–èŠ‚ç‚¹</span>
            <span class="n">let</span> <span class="n">object</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">=</span> <span class="n">alloc_size</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">object</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="n">freeList</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">freeList</span> <span class="o">=</span> <span class="n">object</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="n">object</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span> <span class="o">(</span><span class="n">prev_block</span> <span class="o">+</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">])</span> <span class="o">=</span> <span class="n">object</span> <span class="o">)</span> <span class="o">{</span>
                <span class="c1">// å¦‚æœ prev_block å’Œ object ç›¸è¿ï¼Œåˆ™åˆå¹¶ä¸¤ä¸ªblock</span>
                <span class="n">let</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">+</span> <span class="n">alloc_size</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="c1">// é“¾æ¥ä¸¤ä¸ªblock</span>
                <span class="n">let</span> <span class="n">object</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">=</span> <span class="n">alloc_size</span><span class="o">;</span>
                <span class="n">let</span> <span class="n">object</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
                <span class="n">let</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="n">object</span><span class="o">;</span>
                <span class="n">let</span> <span class="n">prev_block</span> <span class="o">=</span> <span class="n">object</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="o">(</span><span class="n">prev_block</span> <span class="o">+</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">])</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">)</span> <span class="o">{</span>
            <span class="c1">// å°è¯•åˆå¹¶prev_blockå’Œnext_block</span>
            <span class="n">let</span> <span class="n">next_block</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
            <span class="n">let</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">=</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">]</span> <span class="o">+</span> <span class="n">next_block</span><span class="o">[</span><span class="no">FL_LENGTH</span><span class="o">];</span>
            <span class="n">let</span> <span class="n">prev_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="n">next_block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span>
    <span class="o">}</span>    
    
    <span class="cm">/** è¿”å›blockçš„prev_block */</span>
    <span class="n">function</span> <span class="nc">Array</span> <span class="nf">find_prev_free</span><span class="o">(</span><span class="nc">Array</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="nc">Array</span> <span class="n">block</span><span class="o">;</span>
        
        <span class="k">if</span><span class="o">(</span> <span class="n">freeList</span> <span class="o">&gt;</span> <span class="n">object</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="n">let</span> <span class="n">block</span> <span class="o">=</span> <span class="n">freeList</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">]</span> <span class="o">&lt;</span> <span class="n">object</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">block</span> <span class="o">=</span> <span class="n">block</span><span class="o">[</span><span class="no">FL_NEXT</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">block</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="io">I/O</h3>

<p>è®¡ç®—æœºä¸€èˆ¬ä¼šè¿æ¥ä¸€äº›è¾“å…¥è¾“å‡ºè®¾å¤‡ï¼Œä¾‹å¦‚ï¼šæ˜¾ç¤ºå™¨ã€é¼ æ ‡ã€é”®ç›˜ã€ç¡¬ç›˜ã€ç½‘å¡ç­‰ï¼Œè¿™äº›I/Oè®¾å¤‡éƒ½æœ‰è‡ªå·±çš„ç‰¹æ€§ï¼Œåœ¨è¿™äº›è®¾å¤‡ä¸Šè¿›è¡Œè¯»å†™æ“ä½œä¹Ÿæ˜¯å¾ˆå¤æ‚çš„ï¼Œä½†å¯¹äºç¨‹åºå‘˜è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ“ä½œç³»ç»Ÿæ¥æ“ä½œå®ƒä»¬ï¼Œæ“ä½œç³»ç»Ÿä½¿ç”¨ä¸€ç»„é©±åŠ¨ç¨‹åºæ¥å¤„ç†å„ä¸ªI/Oè®¾å¤‡çš„æ“ä½œç»†èŠ‚ï¼Œç„¶åå‘ä¸Šæä¾›ä¸€ç»„å°è£…å¥½çš„APIæ¥å£ã€‚</p>

<p>I/Oè®¾å¤‡å¯¹äºCPUå’Œæ“ä½œç³»ç»Ÿè€Œè¨€ï¼Œå…¶å®æ˜¯ä¸€æ®µå†…å­˜å’Œä¸€ç»„BIOSé©±åŠ¨ç¨‹åºï¼ˆåœ¨Hackä¸­æ²¡æœ‰è¿™äº›é©±åŠ¨ç¨‹åºï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å†™ï¼‰ï¼Œå½“æ“ä½œç³»ç»Ÿæƒ³è¦å’ŒI/Oè®¾å¤‡äº¤äº’æ—¶ï¼Œå°±é€šè¿‡è¿™äº›ç¨‹åºä»ç›¸åº”çš„å†…å­˜ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®ã€‚åœ¨Hackä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªI/Oè®¾å¤‡ï¼šæ˜¾ç¤ºå™¨å’Œé”®ç›˜ï¼Œ
æ˜¾ç¤ºå™¨çš„å†…å­˜æ˜ å°„æ˜¯ä»16384å¼€å§‹çš„è¿ç»­çš„ 8K åœ°å€ç©ºé—´ï¼ˆè¯¥æ˜¾ç¤ºå™¨çš„åˆ†è¾¨ç‡æ˜¯ï¼š512*256ï¼‰ï¼›é”®ç›˜æ›´ç®€å•ï¼Œå®ƒåªæ˜ å°„24576è¿™ä¸€ä¸ªåœ°å€å•å…ƒçš„åœ°å€ç©ºé—´ï¼ˆå› ä¸ºè¶³ä»¥å®¹çº³æ‰€æœ‰è‹±æ–‡å­—ç¬¦å’Œç¬¦å·ï¼‰</p>
<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcycyqes1sj30ww0p4jsi.jpg" width="700" /></center>

<h3 id="é”®ç›˜">é”®ç›˜</h3>

<p>å½“æˆ‘ä»¬æ•²å‡»é”®ç›˜æ—¶ï¼Œæ•²å‡»çš„å­—ç¬¦çš„saciiç ä¼šå†™å…¥åˆ°åœ°å€ä¸º24576çš„å†…å­˜ä¸­ã€‚æˆ‘ä»¬çš„é©±åŠ¨ç¨‹åºè¦åšçš„äº‹æƒ…å°±æ˜¯ï¼Œå®Œæˆä¸€ç»„ç‰¹å®šçš„APIï¼Œä»–ä»¬å¯ä»¥ä»24576å·åœ°å€ä¸­è¯»å–å­—ç¬¦ï¼ˆè¯»å–å•ä¸ªå­—ç¬¦æˆ–è€…å…ˆç»„åˆæˆå­—ç¬¦ä¸²ï¼‰ã€‚</p>
<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcycyp9d74j315i0f6dgw.jpg" width="700" /></center>

<h4 id="ç›‘æµ‹é”®ç›˜è¾“å…¥">ç›‘æµ‹é”®ç›˜è¾“å…¥</h4>

<p>ç¬¬ä¸€ä»¶äº‹éœ€è¦åšçš„æ˜¯ï¼Œç›‘æµ‹åˆ°é”®ç›˜çš„è¾“å…¥ã€‚è¯¥æ–¹æ³•çš„æ ¸å¿ƒå°±æ˜¯ä»é”®ç›˜çš„å†…å­˜æ˜ åƒä¸­è¯»å‡ºå½“å‰æŒ‰ä¸‹çš„å­—ç¬¦çš„asciiç ï¼Œå½“è¯»å–çš„å€¼ä¸ä¸º0çš„æ—¶å€™ï¼Œä»£è¡¨æœ‰å­—ç¬¦è¾“å…¥ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c1">// keyPress() ä¼ªä»£ç </span>
<span class="k">if</span> <span class="n">æœ‰æŒ‰é”®æŒ‰ä¸‹</span>
    <span class="k">return</span> <span class="n">è¯¥é”®çš„saciiç </span>
<span class="k">else</span> 
    <span class="k">return</span> <span class="mi">0</span>

<span class="c1">// Jackå®ç°</span>
<span class="n">function</span> <span class="kt">char</span> <span class="nf">keyPressed</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">keyboard</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="è¯»å–å•ä¸ªå­—ç¬¦">è¯»å–å•ä¸ªå­—ç¬¦</h4>

<p>è¯»å–å•ä¸ªå­—ç¬¦æ—¶æˆ‘ä»¬éœ€è¦é¢å¯¹ä¸¤ä¸ªé—®é¢˜ã€‚ç¬¬ä¸€ä¸ªï¼Œä»€ä¹ˆæƒ…å†µä¸‹æ‰å«ç”¨æˆ·è¾“å…¥äº†ä¸€ä¸ªå•ä¸ªå­—ç¬¦å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å®šä¹‰ç”¨æˆ·æŒ‰ä¸‹ä¸€ä¸ªæŒ‰é”®ï¼Œç„¶åæ¾å¼€æŒ‰é”®ï¼Œè¿™è¿‡ç¨‹ä¼šè¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼ˆå³ä½¿é•¿æ—¶é—´æŒ‰ä½å†æ¾å¼€ä¹Ÿæ˜¯è¾“å…¥ä¸€ä¸ªï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…æ˜¯ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œç„¶åè®°å½•æ•°å€¼ï¼Œç„¶åç­‰å¾…ç”¨æˆ·æ¾å¼€ï¼Œå®Œæˆæœ¬æ¬¡å•ä¸ªå­—ç¬¦è¯»å–ã€‚ç¬¬äºŒä¸ªï¼Œç»™ç”¨æˆ·ä¸€ä¸ªå¯è§†åŒ–åé¦ˆï¼Œå½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå­—ç¬¦åï¼Œéœ€è¦åœ¨å±å¹•ä¸Šå›æ˜¾å‡ºæ¥ï¼Œå¹¶ä¸”è¾…åŠ©ä»¥å…‰æ ‡æç¤ºï¼ˆè™½ç„¶è¿™ä¸ªæ“ä½œçœ‹ä¼¼ç†æ‰€å½“ç„¶ï¼Œä½†å…¶ä¸­ç»è¿‡çš„è¿‡ç¨‹å¹¶ä¸ç®€å•ï¼‰ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1">// readChar() ä¼ªä»£ç </span>

<span class="k">while</span> <span class="n">æ²¡æœ‰ä»»ä½•æŒ‰é”®æŒ‰ä¸‹</span>
    <span class="n">ç­‰å¾…</span><span class="o">...</span><span class="na">ç›´åˆ°æœ‰æŒ‰é”®æŒ‰ä¸‹</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">å½“å‰æŒ‰ä¸‹çš„æŒ‰é”®å€¼</span>

<span class="k">while</span> <span class="n">å½“å‰æŒ‰é”®è¿˜å¤„äºæŒ‰ä¸‹çŠ¶æ€</span>
    <span class="n">ç­‰å¾…</span><span class="o">...</span><span class="na">ç›´åˆ°æŒ‰é”®æ¾å¼€</span>

<span class="n">print</span> <span class="n">c</span> <span class="c1">// æŠŠå­—ç¬¦å›æ˜¾åˆ°å±å¹•ä¸Š</span>
<span class="n">å°†å…‰æ ‡å³ç§»ä¸€æ ¼</span>

<span class="k">return</span> <span class="n">c</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c1">// jackå®ç°</span>
<span class="n">function</span> <span class="kt">char</span> <span class="nf">readChar</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">char</span> <span class="n">key</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">keyPressed</span><span class="o">()</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{}</span>
    <span class="n">let</span> <span class="n">key</span> <span class="o">=</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">keyPressed</span><span class="o">();</span>
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="nc">Keyboard</span><span class="o">.</span><span class="na">keyPressed</span><span class="o">()</span> <span class="o">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">)</span> <span class="o">{}</span>
    <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printChar</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">key</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="è¯»å–ä¸€è¡Œå­—ç¬¦">è¯»å–ä¸€è¡Œå­—ç¬¦</h4>

<p>ç„¶åæˆ‘ä»¬åœ¨ readChar() çš„åŸºç¡€ä¸Šæ‰©å±•å‡º readLine()ï¼ŒreadLine()éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ã€‚ç¬¬ä¸€ä¸ªï¼ŒæŠŠè¯»å–çš„å•ä¸ªå­—ç¬¦å†™å…¥å­—ç¬¦ä¸²ç¼“å†²åŒºï¼Œç›´åˆ°è¾“å…¥æ¢è¡Œç¬¦æ—¶ç»“æŸã€‚ç¬¬äºŒä¸ªï¼Œå…è®¸ç”¨æˆ·åœ¨è¾“å…¥è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ é™¤é”®åˆ é™¤</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">// readLine() ä¼ªä»£ç </span>
<span class="n">s</span> <span class="o">=</span> <span class="n">ç©ºå­—ç¬¦ä¸²</span>
<span class="n">repeat</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">readChar</span><span class="o">()</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">=</span> <span class="n">æ¢è¡Œç¬¦</span>
        <span class="n">print</span> <span class="n">æ¢è¡Œç¬¦</span>
        <span class="k">return</span> <span class="n">s</span>
    <span class="k">else</span> <span class="k">if</span> <span class="n">c</span> <span class="o">=</span> <span class="n">é€€æ ¼é”®</span>
        <span class="n">s</span> <span class="n">åˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦</span>
        <span class="n">å…‰æ ‡å·¦ç§»ä¸€æ ¼</span>
    <span class="k">else</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">c</span><span class="o">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c1">// Jackå®ç°</span>
<span class="n">function</span> <span class="nc">String</span> <span class="nf">readLine</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="nc">String</span> <span class="n">line</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">char</span> <span class="n">c</span><span class="o">;</span>
    
    <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    
    <span class="n">let</span> <span class="n">line</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span>     <span class="c1">// max length</span>
    <span class="n">let</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">readChar</span><span class="o">();</span>
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">c</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">newLine</span><span class="o">())</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">backSpace</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">do</span> <span class="n">line</span><span class="o">.</span><span class="na">eraseLastChar</span><span class="o">();</span>
            <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">backSpace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">do</span> <span class="n">line</span><span class="o">.</span><span class="na">appendChar</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">let</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">readChar</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">line</span><span class="o">;</span>
<span class="o">}</span>   
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯ä»¥çœ‹åˆ°ï¼Œé”®ç›˜è¾“å…¥çš„è®¾è®¡å®ç°è¿˜æ˜¯åŸºäºä¸€ç³»åˆ—çº§è”çš„åˆ†å±‚æŠ½è±¡ã€‚é«˜çº§ç¨‹åºreadLine()ä¾èµ–readChar()ï¼ŒreadChar()ä¾èµ–äºkeyPress()ï¼ŒkeyPress()ä¾èµ–äºç¡¬ä»¶ã€‚å¯è§åˆ†å±‚æŠ½è±¡çš„è®¾è®¡æ¨¡å¼è´¯ç©¿äº†æ•´ä¸ªè®¡ç®—æœºçš„å®è§‚æ¶æ„å’Œå¾®è§‚å®ç°ï¼Œå¯ä»¥è¯´æ˜¯è®¡ç®—æœºç§‘å­¦çš„ç²¾åæ€æƒ³ã€‚</p>

<h3 id="å›¾å½¢æ˜¾ç¤º">å›¾å½¢æ˜¾ç¤º</h3>

<p>ç°ä»£è®¡ç®—æœºå¤§å¤šä½¿ç”¨ä½å›¾ï¼ˆbitmapï¼‰æˆ–ç§°å…‰æ …ï¼ˆrasterï¼‰çš„æŠ€æœ¯æ¥æ˜¾ç¤ºå›¾å½¢æˆ–æ–‡å­—ã€‚å±å¹•ç”±ä¸€ç»„äºŒç»´çš„å¹³é¢ç‚¹ç»„æˆï¼Œæ¯ä¸ªç‚¹æ˜¯ä¸€ä¸ªåƒç´ ï¼ˆpixelï¼‰ï¼Œæ¯ä¸ªåƒç´ ç‚¹å¯¹åº”åˆ°æ˜¾å­˜ä¸­çš„æŸä¸ªåœ°å€ï¼Œè®¡ç®—æœºè¦åšçš„å°±æ˜¯ç»™æ¯ä¸ªåƒç´ ç‚¹èµ‹ä¸Šä¸€ä¸ªé¢œè‰²çš„å€¼ï¼ŒHackåªæ”¯æŒé»‘å’Œç™½ï¼Œå› æ­¤åªå 1bitï¼Œå¦‚æœæ˜¾ç¤ºå™¨æ”¯æŒå½©è‰²æ˜¾ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªåƒç´ å°±ä¼šå ç”¨æ›´å¤šbitçš„å†…å­˜ã€‚</p>

<p>Hackçš„å±å¹•åˆ†è¾¨ç‡æ˜¯512*256ï¼Œå³å±å¹•ä¸Šæœ‰131072ä¸ªåƒç´ ç‚¹ã€‚åƒç´ ç‚¹å’Œæ˜¾å­˜çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼šç°å­˜ä¸­æ¯ä¸ªBitå¯¹åº”ä¸€ä¸ªåƒç´ ç‚¹ï¼ˆ1ä»£è¡¨é»‘è‰²ï¼Œ0ä»£è¡¨ç™½è‰²ï¼‰ï¼Œä¸€è¡Œ512ä¸ªåƒç´ éœ€è¦å¯¹åº” 32*16bitï¼ˆä¸€ä¸ªwordï¼‰ï¼Œ32word/è¡Œ*256è¡Œ=8192wordï¼Œæ­£å¥½æ˜¯8Kåœ°å€ç©ºé—´ã€‚å› æ­¤å­˜åœ¨å¯¹åº”å…³ç³»ï¼šç¬¬rè¡Œç¬¬cåˆ—çš„åƒç´ ç‚¹ï¼Œå¯¹åº”åœ°å€ä¸º Screen[r*32+c/16] çš„wordçš„ç¬¬ c%16 çš„bitã€‚</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcz4oayk2sj30tq0dg74b.jpg" width="700" /></center>

<h4 id="ç‚¹">ç‚¹</h4>

<p>äº†è§£äº†ä¸Šé¢åƒç´ ç‚¹å’Œå†…å­˜bitçš„å¯¹åº”å…³ç³»åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºç»™å•ä¸€åƒç´ ç‚¹èµ‹å€¼çš„æ–¹æ³•äº†ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="cm">/** ç»˜åˆ¶åƒç´ ç‚¹ (x, y) */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">drawPixel</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">address</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">mask</span><span class="o">;</span>

    <span class="n">let</span> <span class="n">address</span> <span class="o">=</span> <span class="o">(</span><span class="n">y</span><span class="o">*</span><span class="mi">32</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="n">x</span><span class="o">/</span><span class="mi">16</span><span class="o">);</span>       <span class="c1">// å…ˆæ‰¾åˆ°ç¬¬å‡ ä¸ªword</span>
    <span class="n">let</span> <span class="n">mask</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">two_to_the</span><span class="o">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="o">);</span>  <span class="c1">// å†æ‰¾åˆ°è¯¥wordçš„ç¬¬å‡ ä¸ªbitï¼Œå¹¶è½¬æˆæ©ç çš„å½¢å¼ã€‚ä¾‹å¦‚ç¬¬4ä¸ªbitï¼Œå¯¹åº”0000000000000100</span>

    <span class="k">if</span><span class="o">(</span> <span class="n">cur_colour</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">screen</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">=</span> <span class="n">screen</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">|</span> <span class="n">mask</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">screen</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">=</span> <span class="n">screen</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">mask</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** æ¸…é™¤å±å¹• */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">clearScreen</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8192</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">screen</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">white</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** è®¾ç½®å°†è¦ä½¿ç”¨çš„color white = false, black = true. */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">setColor</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">let</span> <span class="n">cur_colour</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="çº¿">çº¿</h4>

<p>ç‚¹å¾ˆå®¹æ˜“ç»˜åˆ¶ï¼Œçº¿åˆ™å¤æ‚å¾ˆå¤šã€‚ç”±äºåƒç´ ç‚¹æ˜¯ä¸€ä¸ªä¸ªçŸ©å½¢çš„å°æ–¹å—ï¼Œæ‰€ä»¥é™¤äº†æ¨ªçº¿å’Œç«–çº¿ï¼Œæˆ‘ä»¬æ— æ³•ç»˜åˆ¶å‡ºå®Œå…¨ç¬”ç›´çš„çº¿ï¼ˆæ–œçº¿éƒ½æ˜¯å¸¦é”¯é½¿æ¯›è¾¹çš„ï¼‰ï¼Œå½“ç„¶é€šè¿‡ç¼©å°åƒç´ ç‚¹çš„å¤§å°æˆ‘ä»¬å¯ä»¥æ— é™é€¼è¿‘ç¬”ç›´ï¼ˆå½“åƒç´ ç‚¹å°åˆ°äººçœ¼æ— æ³•åˆ†è¾¨æ—¶å°±å¯ä»¥äº†ï¼Œå³æ‰€è°“çš„è§†ç½‘è†œå±å¹•ï¼‰ã€‚</p>
<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gcz5056jtyj30j00cyq2x.jpg" width="500" /></center>

<p>æˆ‘ä»¬åœ¨ç»˜åˆ¶çº¿çš„æ—¶å€™ï¼Œåˆ†ä¸º3ç§åœºæ™¯ï¼šæ¨ªçº¿ã€ç«–çº¿å’Œæ–œçº¿ã€‚å…¶ä¸­æ¨ªçº¿å’Œç«–çº¿éƒ½æ¯”è¾ƒå®¹æ˜“å®ç°ï¼Œç»˜åˆ¶æ–œçº¿åˆ™å¤æ‚ä¸€äº›ï¼Œéœ€è¦å€ŸåŠ©ç‰¹å®šçš„ç®—æ³•ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="cm">/** ä» (x1, y1) åˆ° (x2, y2) ç»˜åˆ¶ä¸€æ¡çº¿ */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">drawLine</span><span class="o">(</span><span class="kt">int</span> <span class="n">x1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y2</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">dx</span><span class="o">,</span> <span class="n">dy</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">temp</span><span class="o">;</span>
    
    <span class="c1">// ä¿è¯ x1 &lt;= x2</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">x1</span> <span class="o">&gt;</span> <span class="n">x2</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">x1</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">y1</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y2</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">let</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="o">;</span>
    
    <span class="k">if</span><span class="o">(</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawVerticalLine</span><span class="o">(</span> <span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">,</span> <span class="n">y2</span> <span class="o">);</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span> <span class="k">if</span><span class="o">(</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawHorizontalLine</span><span class="o">(</span> <span class="n">x1</span><span class="o">,</span> <span class="n">x2</span><span class="o">,</span> <span class="n">y1</span> <span class="o">);</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawDiagonalLine</span><span class="o">(</span> <span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">,</span> <span class="n">x2</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">dx</span><span class="o">,</span> <span class="n">dy</span> <span class="o">);</span>
    <span class="o">}}</span>
    
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 id="ç«–çº¿">ç«–çº¿</h5>

<p>ç»˜åˆ¶ç«–çº¿è¾ƒå®¹æ˜“ï¼Œè°ƒç”¨ drawPixel() æ–¹æ³•ï¼Œä» y1 ç»˜åˆ¶åˆ° y2 å³å¯ï¼ˆy1&lt;=y2ï¼‰ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">void</span> <span class="nf">drawVerticalLine</span><span class="o">(</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y2</span> <span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">temp</span><span class="o">;</span>
    
    <span class="c1">// ä¿è¯ y1 &lt;= y2</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">y1</span> <span class="o">&gt;</span> <span class="n">y2</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">y1</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y2</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">y1</span> <span class="o">&gt;</span> <span class="n">y2</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawPixel</span><span class="o">(</span> <span class="n">x</span><span class="o">,</span> <span class="n">y1</span> <span class="o">);</span>
        <span class="n">let</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 id="æ¨ªçº¿">æ¨ªçº¿</h5>

<p>æ¨ªçº¿çš„å®ç°æ–¹å¼å¯ä»¥å’Œç«–çº¿ä¸€æ ·ï¼Œä¸€ä¸ªä¸ªåƒç´ çš„ç»˜åˆ¶å®Œå³å¯ã€‚ä½†è¿™é‡Œæˆ‘ä»¬åšä¸€ä¸ªå°ä¼˜åŒ–ï¼Œä¸€æ¡æ¨ªçº¿ä¼šæ¨ªè·¨nä¸ªwordï¼Œé™¤äº†å¤´å’Œå°¾ï¼Œä¸­é—´çš„wordéƒ½æ˜¯è¿ç»­çš„ï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥ä¸ºè¿™äº›wordä¸€æ¬¡æ€§èµ‹å€¼16ä¸ªbitï¼Œè¿™æ ·å¾ªç¯çš„æ¬¡æ•°ä¼šç¼©çŸ­16å€ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">void</span> <span class="nf">drawHorizontalLine</span><span class="o">(</span> <span class="kt">int</span> <span class="n">x1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">start_addr</span><span class="o">,</span> <span class="n">end_addr</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">x1mod16</span><span class="o">,</span> <span class="n">x2mod16</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">x1mod16</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="o">;</span>               <span class="c1">// çº¿åœ¨ä¸€ä¸ªwordå†…çš„åç§»é‡</span>
    <span class="n">let</span> <span class="n">x2mod16</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="o">;</span>               <span class="c1">// çº¿åœ¨æœ€åä¸€ä¸ªwordå†…çš„åç§»é‡</span>
    <span class="n">let</span> <span class="n">start_addr</span> <span class="o">=</span> <span class="o">(</span><span class="n">y</span><span class="o">*</span><span class="mi">32</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="n">x1</span><span class="o">/</span><span class="mi">16</span><span class="o">);</span>
    <span class="n">let</span> <span class="n">end_addr</span> <span class="o">=</span> <span class="o">(</span><span class="n">y</span><span class="o">*</span><span class="mi">32</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="n">x2</span><span class="o">/</span><span class="mi">16</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="n">x2mod16</span><span class="o">=</span><span class="mi">0</span><span class="o">);</span>

    <span class="k">if</span><span class="o">(</span> <span class="n">start_addr</span> <span class="o">=</span> <span class="n">end_addr</span> <span class="o">)</span> <span class="o">{</span>        <span class="c1">// çº¿çš„é•¿åº¦åœ¨ä¸€ä¸ªwordå†…</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">draw_short_horizontal_line</span><span class="o">(</span> <span class="n">x1</span><span class="o">,</span> <span class="n">x2</span><span class="o">,</span> <span class="n">y</span> <span class="o">);</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span> 
        <span class="k">if</span><span class="o">(</span> <span class="o">~(</span><span class="n">x1mod16</span> <span class="o">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>           <span class="c1">// çº¿åœ¨ç¬¬ä¸€ä¸ªWordå†…çš„ä¸€å°æ®µ</span>
            <span class="n">let</span> <span class="n">start_addr</span> <span class="o">=</span> <span class="n">start_addr</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">draw_short_horizontal_line</span><span class="o">(</span> <span class="n">x1</span><span class="o">,</span> <span class="n">x1</span><span class="o">+</span><span class="mi">16</span><span class="o">-</span><span class="n">x1mod16</span><span class="o">,</span> <span class="n">y</span> <span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span> <span class="o">~(</span><span class="n">x2mod16</span> <span class="o">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>           <span class="c1">// çº¿åœ¨æœ€åä¸ªWordå†…çš„ä¸€å°æ®µ</span>
            <span class="n">let</span> <span class="n">end_addr</span> <span class="o">=</span> <span class="n">end_addr</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
            <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">draw_short_horizontal_line</span><span class="o">(</span> <span class="n">x2</span><span class="o">-</span><span class="n">x2mod16</span><span class="o">,</span> <span class="n">x2</span><span class="o">,</span> <span class="n">y</span> <span class="o">);</span>
        <span class="o">}</span>
        <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">start_addr</span> <span class="o">&gt;</span> <span class="n">end_addr</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>     <span class="c1">// ä¸­é—´çš„è‹¥å¹²æ®µword</span>
            <span class="n">let</span> <span class="n">screen</span><span class="o">[</span><span class="n">start_addr</span><span class="o">]</span> <span class="o">=</span> <span class="n">cur_colour</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">start_addr</span> <span class="o">=</span> <span class="n">start_addr</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">function</span> <span class="kt">void</span> <span class="nf">draw_short_horizontal_line</span><span class="o">(</span> <span class="kt">int</span> <span class="n">x1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">)</span> <span class="o">{</span>
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">x1</span> <span class="o">&gt;</span> <span class="n">x2</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawPixel</span><span class="o">(</span> <span class="n">x1</span><span class="o">,</span> <span class="n">y</span> <span class="o">);</span>
        <span class="n">let</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 id="æ–œçº¿">æ–œçº¿</h5>

<p>æ–œçº¿çš„ç»˜åˆ¶æ³•æ¯”ç›´çº¿å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ç»˜åˆ¶åƒç´ ç‚¹çš„æ—¶å€™åªèƒ½å‘ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªæ–¹å‘ç»˜åˆ¶ï¼Œè€Œä¸èƒ½æ–œç€ç»˜åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å°½é‡è®©æˆ‘ä»¬çš„æ–œçº¿å’Œç›®æ ‡æ–œçº¿è¿‘ä¼¼ã€‚ä¸ºäº†å®Œæˆç»˜åˆ¶æ–œçº¿ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥æ–œç‡æ¥è¾…åŠ©ï¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨ç»˜åˆ¶æ–œçº¿æ—¶ï¼Œæ–°ç»˜åˆ¶çš„åƒç´ ç‚¹çš„è¿åŠ¨ä½ç½®æ˜¯åƒè›‡ä¸€æ ·å·¦å³èœ¿èœ’å‰è¿›çš„ï¼Œæˆ‘ä»¬çš„ç®—æ³•çš„ç›®çš„å°±æ˜¯åˆ«è®©è¿™æ¡è›‡è·‘åï¼Œå½“å‰æ–œç‡å°äºç›®æ ‡æ–œç‡æ—¶ï¼Œæˆ‘ä»¬å°±å‘ä¸Šç»˜åˆ¶åƒç´ ç‚¹ä»¥å¢å¤§æ–œç‡ï¼›å½“å‰æ–œç‡å¤§äºç›®æ ‡æ–œç‡æ—¶ï¼Œæˆ‘ä»¬å°±å‘å³ç»˜åˆ¶åƒç´ ç‚¹ä»¥å‡å°æ–œç‡ã€‚</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gczghjqsrsj314m0fqgmc.jpg" width="700" /></center>

<p>ç®—æ³•æ€æƒ³å¦‚ä¸Šè¿°ï¼Œæˆ‘ä»¬ä¸‹é¢è¦åšçš„å°±æ˜¯å®ç°å®ƒçš„æ™®éé€‚ç”¨ç‰ˆæœ¬ï¼ˆä¸åŒæ–¹å‘çš„æ–œçº¿ï¼‰ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">void</span> <span class="nf">drawDiagonalLine</span><span class="o">(</span> <span class="kt">int</span> <span class="n">x1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">dx</span><span class="o">,</span> <span class="kt">int</span> <span class="n">dy</span> <span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">adyMinusbdx</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">y_incr</span><span class="o">;</span>

    <span class="n">let</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">adyMinusbdx</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    
    <span class="k">if</span><span class="o">(</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>  <span class="c1">// æ–œçº¿æ–¹å‘</span>
        <span class="n">let</span> <span class="n">y_incr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">y_incr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">dx</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(((</span><span class="n">y_incr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">~(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="n">dy</span><span class="o">))</span> <span class="o">|</span> <span class="o">((</span><span class="n">y_incr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">~(</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">dy</span><span class="o">)))</span> <span class="o">)</span> <span class="o">{</span>  <span class="c1">// æ˜¯å¦ç»˜åˆ¶åˆ°äº†ç»ˆç‚¹</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawPixel</span><span class="o">(</span> <span class="n">x1</span><span class="o">+</span><span class="n">a</span><span class="o">,</span> <span class="n">y1</span><span class="o">+</span><span class="n">b</span> <span class="o">);</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">adyMinusbdx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>  <span class="c1">// å¦‚æœæ–œç‡åå¤§ï¼Œå‘å³ç»˜åˆ¶</span>
            <span class="n">let</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">adyMinusbdx</span> <span class="o">=</span> <span class="n">adyMinusbdx</span> <span class="o">+</span> <span class="o">(</span><span class="n">dy</span><span class="o">*</span><span class="n">y_incr</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>                   <span class="c1">// å¦‚æœæ–œç‡åå°ï¼Œå‘ä¸Šï¼ˆä¸‹ï¼‰ç»˜åˆ¶</span>
            <span class="n">let</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y_incr</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">adyMinusbdx</span> <span class="o">=</span> <span class="n">adyMinusbdx</span> <span class="o">-</span> <span class="n">dx</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="çŸ©å½¢">çŸ©å½¢</h4>

<p>çŸ©å½¢çš„ç»˜åˆ¶æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ç»˜åˆ¶næ¡æ¨ªçº¿å³å¯ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">void</span> <span class="nf">drawRectangle</span><span class="o">(</span><span class="kt">int</span> <span class="n">x1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y2</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">y2</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawHorizontalLine</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span> <span class="n">x2</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
        <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="åœ†">åœ†</h4>

<p>åœ†ä¹Ÿæœ‰ä¸€ä¸ªç®€å•çš„ç»˜åˆ¶ç®—æ³•ï¼šä»ä¸Šåˆ°ä¸‹ä¸€è¡Œè¡Œçš„ç»˜åˆ¶ï¼Œä¸€ç§æ¯ä¸€è¡Œçš„é•¿åº¦éƒ½å¯ä»¥æ ¹æ®åŠå¾„rå’Œåç§»é‡dyè®¡ç®—å‡ºæ¥ï¼ˆæ¶‰åŠåˆ°å¹³æ–¹å’Œå¼€å‘è¿ç®—ï¼Œæˆ‘ä»¬åœ¨Mathç±»æ±‡ä¸­å·²ç»å®ç°ï¼‰</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gczk5m3xerj30xo0kg0tb.jpg" width="700" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="n">function</span> <span class="kt">void</span> <span class="nf">drawCircle</span><span class="o">(</span><span class="kt">int</span> <span class="n">cx</span><span class="o">,</span> <span class="kt">int</span> <span class="n">cy</span><span class="o">,</span> <span class="kt">int</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">dx</span><span class="o">,</span> <span class="n">dy</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">r_squared</span><span class="o">;</span>
    
    <span class="n">let</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="o">~(</span><span class="n">dy</span> <span class="o">&gt;</span> <span class="n">r</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">dx</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">r_squared</span><span class="o">-(</span><span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="o">));</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawHorizontalLine</span><span class="o">(</span> <span class="n">cx</span><span class="o">-</span><span class="n">dx</span><span class="o">,</span> <span class="n">cx</span><span class="o">+</span><span class="n">dx</span><span class="o">,</span> <span class="n">cy</span><span class="o">+</span><span class="n">dy</span> <span class="o">);</span>
        <span class="n">let</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="æ–‡å­—æ˜¾ç¤º">æ–‡å­—æ˜¾ç¤º</h3>

<p>ä¸ºäº†åœ¨å±å¹•ä¸Šè¾“å‡ºæ–‡å­—ï¼Œæˆ‘ä»¬æŠŠ512*256çš„å±å¹•åˆ’åˆ†æˆè‹¥å¹²ä¸ª8*11å¤§å°çš„çš„æ–¹æ ¼å­ï¼ˆæ€»å…±åˆ’åˆ†äº†64*23ä¸ªï¼‰ï¼Œåœ¨æ¯ä¸ªæ–¹æ ¼å­ä¸­æˆ‘ä»¬å¯ä»¥åˆ©ç”¨88ä¸ªåƒç´ ç‚¹æ¥ç»˜åˆ¶æ–‡å­—ï¼Œä»¥ä¸‹å›¾çš„ä¸ºä¾‹ã€‚</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1gzswkhoj30ja0pumxb.jpg" width="300" /></center>

<p>å®ç°æ–‡å­—ç»˜åˆ¶çš„é€»è¾‘ä¹Ÿæ˜¯æ¯”ç®€å•çš„ï¼Œæœ€é‡è¦çš„æ˜¯è¦å…ˆè®¾è®¡å‡ºå­—ç¬¦çš„bitMapï¼ˆå­—ç¬¦çš„bitMapå†³å®šäº†å­—ç¬¦çš„å­—å½¢å’Œå­—ä½“ï¼‰ï¼ŒHackæ”¯æŒ127ä¸­å­—ç¬¦çš„å±•ç¤ºï¼Œè¿™é‡Œæˆ‘ä»¬åˆ—å‡ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="rouge-code"><pre><span class="c1">// é»‘è‰²æ–¹å—                                          </span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>

<span class="c1">// å„ä¸ªå­—ç¬¦çš„ bitmap</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">32</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>          <span class="c1">//</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">33</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>  <span class="c1">// !</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">34</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">20</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>       <span class="c1">// "</span>
<span class="o">......</span>

<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">48</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// 0</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">49</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">14</span><span class="o">,</span><span class="mi">15</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// 1</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">50</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">48</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>   <span class="c1">// 2</span>
<span class="o">......</span>

<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">58</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>      <span class="c1">// :</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">59</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>      <span class="c1">// ;</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">60</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>      <span class="c1">// &lt;</span>
<span class="o">......</span>

<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// A</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">66</span><span class="o">,</span><span class="mi">31</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">31</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">31</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// B</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">67</span><span class="o">,</span><span class="mi">28</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">35</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">35</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">28</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>    <span class="c1">// C</span>
<span class="o">......</span>

<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">91</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>          <span class="c1">// [</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">92</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">48</span><span class="o">,</span><span class="mi">32</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>        <span class="c1">// \</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">93</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>   <span class="c1">// ]</span>
<span class="o">......</span>

<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">97</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">14</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">27</span><span class="o">,</span><span class="mi">27</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>      <span class="c1">// a</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">98</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">15</span><span class="o">,</span><span class="mi">27</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>      <span class="c1">// b</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">99</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">51</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>        <span class="c1">// c</span>
<span class="o">......</span>

<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">123</span><span class="o">,</span><span class="mi">56</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">56</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>   <span class="c1">// {</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">124</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>  <span class="c1">// |</span>
<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="mi">125</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">56</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>    <span class="c1">// }</span>
<span class="o">......</span>

<span class="c1">// åˆ›å»ºä¸€ä¸ª8*11çš„bitMap, å…¶ä¸­ a,b,c ä»£è¡¨å…¶ä¸­æŸä¸€è¡Œçš„bitMapæƒ…å†µ</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">,</span> <span class="kt">int</span> <span class="n">c</span><span class="o">,</span> <span class="kt">int</span> <span class="n">d</span><span class="o">,</span> <span class="kt">int</span> <span class="n">e</span><span class="o">,</span> <span class="kt">int</span> <span class="n">f</span><span class="o">,</span> <span class="kt">int</span> <span class="n">g</span><span class="o">,</span> <span class="kt">int</span> <span class="n">h</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">,</span> <span class="kt">int</span> <span class="n">k</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="nc">Array</span> <span class="n">map</span><span class="o">;</span>

    <span class="n">let</span> <span class="n">map</span> <span class="o">=</span> <span class="nc">Array</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="mi">11</span><span class="o">);</span>
    <span class="n">let</span> <span class="n">charMaps</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="n">map</span><span class="o">;</span>

    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span> <span class="o">=</span> <span class="n">h</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">9</span><span class="o">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">map</span><span class="o">[</span><span class="mi">10</span><span class="o">]</span> <span class="o">=</span> <span class="n">k</span><span class="o">;</span>

    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>é™¤äº†å­—ç¬¦ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é€šè¿‡å…‰æ ‡æ¥è¾…åŠ©æŒ‡ç¤ºå½“å‰å­—ç¬¦æ˜¾ç¤ºçš„ä½ç½®ï¼ŒåŒ…æ‹¬å‘å‰ã€å‘åç§»åŠ¨ï¼Œæ¢è¡Œï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="cm">/** ç§»åŠ¨å…‰æ ‡ä½ç½® */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">moveCursor</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">let</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="n">j</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">cursor_y</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** åœ¨å±å¹•ä¸Šæ¢è¡Œ */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">println</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">let</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">cursor_y</span> <span class="o">&lt;</span> <span class="mi">22</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">cursor_y</span> <span class="o">=</span> <span class="n">cursor_y</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">scroll</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** å±å¹•ç¿»é¡µ */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">scroll</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">let</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">cursor_y</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** é€€æ ¼ */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">backSpace</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="o">~(</span><span class="n">cursor_y</span> <span class="o">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="mi">63</span><span class="o">;</span>
            <span class="n">let</span> <span class="n">cursor_y</span> <span class="o">=</span> <span class="n">cursor_y</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="n">cursor_x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æœ€åæ˜¯åœ¨å…‰æ ‡çš„ä½ç½®æ‰“å°ä¸€ä¸ªå­—ç¬¦ï¼ˆæˆ–ä¸€ä¸²å­—ç¬¦ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ï¼šå…ˆæ ¹æ®å…‰æ ‡çš„ä½ç½®è®¡ç®—å‡ºå­—ç¬¦åº”è¯¥å ç”¨çš„å†…å­˜çš„ä½ç½®ï¼Œç„¶åæŠŠå­—ç¬¦çš„ bitMap å¡«å……åˆ°è¿™å—å†…å­˜çš„è¿‡ç¨‹ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="rouge-code"><pre><span class="cm">/** åœ¨å±å¹•ä¸Šæ‰“å°å­—ç¬¦ï¼Œå¹¶å°†å…‰æ ‡ä½ç½®å‘å‰ç§»åŠ¨ä¸€æ ¼ */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">printChar</span><span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="nc">Array</span> <span class="n">map</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">address</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">mask</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">bitmap</span><span class="o">;</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
    
    <span class="c1">// è·å–å­—ç¬¦çš„bitMapï¼Œåœ°å€é”šç‚¹åˆ°å½“å‰å…‰æ ‡ä½ç½®</span>
    <span class="n">let</span> <span class="n">map</span> <span class="o">=</span> <span class="nc">Output</span><span class="o">.</span><span class="na">getMap</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="n">let</span> <span class="n">address</span> <span class="o">=</span> <span class="o">(</span><span class="n">cursor_y</span><span class="o">*</span><span class="mi">32</span><span class="o">*</span><span class="mi">11</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="n">cursor_x</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span>
    <span class="n">let</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cursor_x</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">;</span>
    
    <span class="c1">// æŠŠbitMapçš„å€¼ï¼Œå¡«å……åˆ°é”šç‚¹åˆ°çš„å†…å­˜ï¼ˆ11*8çš„æ–¹å—ï¼‰</span>
    <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">bitmap</span> <span class="o">=</span> <span class="n">map</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">bitmap</span> <span class="o">=</span> <span class="n">bitmap</span> <span class="o">*</span> <span class="mi">256</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">let</span> <span class="n">screen</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">=</span> <span class="n">screen</span><span class="o">[</span><span class="n">address</span><span class="o">]</span> <span class="o">&amp;</span> <span class="n">charMasks</span><span class="o">[</span><span class="n">mask</span><span class="o">]</span> <span class="o">|</span> <span class="n">bitmap</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">address</span> <span class="o">=</span> <span class="n">address</span> <span class="o">+</span> <span class="mi">32</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// ç§»åŠ¨å…‰æ ‡ä½ç½®</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="mi">63</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">cursor_x</span> <span class="o">=</span> <span class="n">cursor_x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** åœ¨å±å¹•ä¸Šæ‰“å°ä¸€ä¸ªå­—ç¬¦ */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">printString</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">while</span><span class="o">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printChar</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/** åœ¨å±å¹•ä¸Šæ‰“å°ä¸€ä¸ªæ•°å­— */</span>
<span class="n">function</span> <span class="kt">void</span> <span class="nf">printInt</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="nc">String</span> <span class="n">s</span><span class="o">;</span>
    <span class="n">let</span> <span class="n">s</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
    <span class="k">do</span> <span class="n">s</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
    <span class="k">do</span> <span class="n">s</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="system">System</h3>

<p>æˆ‘ä»¬å®Œæˆäº†ä¸€ç³»åˆ—çš„Jackæ“ä½œç³»ç»Ÿçš„åŸºç¡€åº“ï¼Œå®ƒä»¬æé«˜äº†æˆ‘ä»¬ä½¿ç”¨Jackç¼–å†™ç¨‹åºçš„æ•ˆç‡ï¼Œæ‹“å±•äº†ç¨‹åºçš„äººæœºäº¤äº’èƒ½åŠ›ã€‚æœ€åæˆ‘ä»¬éœ€è¦å†å†™ä¸€ä¸ªSystemç±»ï¼ŒæŠŠè¿™äº›åº“æ•´åˆèµ·æ¥ï¼Œå½¢æˆJackæ“ä½œç³»ç»Ÿã€‚é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“æ“ä½œç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä¸ªç¨‹åºï¼Œå½“è®¡ç®—æœºå¯åŠ¨æ—¶ï¼Œé¦–å…ˆè¢«æ‰§è¡Œçš„ç¨‹åºå°±æ˜¯æ“ä½œç³»ç»Ÿï¼ˆå‡†ç¡®çš„è¯´å…ˆæ‰§è¡Œå¼•å¯¼ç¨‹åºï¼Œå¼•å¯¼æ‰§è¡Œæ“ä½œç³»ç»Ÿç¨‹åºï¼‰ã€‚Jackæ“ä½œç³»ç»Ÿä¼šå…ˆæ‰§è¡Œä¸€ç³»åˆ—æ ‡å‡†åº“åˆå§‹åŒ–å·¥ä½œï¼Œç„¶åå†æŠŠæ‰§è¡Œäº¤ç»™ä¸»ç¨‹åºï¼Œä¸»ç¨‹åºæ‰§è¡Œå®Œåï¼ˆå¦‚æœä¸»ç¨‹åºä¸æ˜¯ä»¥æ— é™å¾ªç¯çš„æ–¹å¼æ‰§è¡Œçš„è¯ï¼‰ï¼Œæ“ä½œç³»ç»ŸæŠŠè®¡ç®—æœºæŒ‚èµ·ï¼ˆæ— é™å¾ªç¯çš„æ–¹å¼ï¼‰ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Sys</span> <span class="o">{</span>

    <span class="n">function</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Math</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>    <span class="c1">// ç³»ç»Ÿåº“åˆå§‹åŒ–</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>
        <span class="k">do</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>
        <span class="k">do</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>
        <span class="k">do</span> <span class="nc">Main</span><span class="o">.</span><span class="na">main</span><span class="o">();</span>    <span class="c1">// æ‰§è¡Œä¸»ç¨‹åº</span>
        <span class="k">do</span> <span class="nc">Sys</span><span class="o">.</span><span class="na">halt</span><span class="o">();</span>     <span class="c1">// å®Œæˆä¸»ç¨‹åºåï¼ŒæŒ‚èµ·</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** æŒ‚èµ·ï¼šæ— é™å¾ªç¯ */</span>
    <span class="n">function</span> <span class="kt">void</span> <span class="nf">halt</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">){}</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** Wait ä¸€å°æ®µæ—¶é—´ */</span>
    <span class="n">function</span> <span class="kt">void</span> <span class="nf">wait</span><span class="o">(</span><span class="kt">int</span> <span class="n">duration</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">duration</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">let</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="k">while</span><span class="o">(</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">200</span> <span class="o">)</span> <span class="o">{</span>
                <span class="n">let</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** æ‰“å°é”™è¯¯ä¿¡æ¯ */</span>
    <span class="n">function</span> <span class="kt">void</span> <span class="nf">error</span><span class="o">(</span><span class="kt">int</span> <span class="n">errorCode</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="s">"Err"</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printInt</span><span class="o">(</span><span class="n">errorCode</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Sys</span><span class="o">.</span><span class="na">halt</span><span class="o">();</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="æ€»ç»“">æ€»ç»“</h3>

<p>å¯ä»¥è¯´æˆ‘ä»¬æœ¬ç¯‡å®ç°çš„æ“ä½œç³»ç»Ÿå®Œå…¨ç®—ä¸ä¸Šä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„æ“ä½œç³»ç»Ÿï¼Œæœ€ç»ˆè¿™ä¸ªæ“ä½œç³»ç»Ÿå’Œæˆ‘ä»¬çš„ä¸»ç¨‹åºä¼šè¢«ä¸€èµ·ç¼–è¯‘ï¼Œç”Ÿæˆä¸€ä¸ªé™æ€ç¨‹åºã€‚æœ€ç»ˆHackæ‰§è¡Œçš„æ˜¯è¿™ä¸ªç›®æ ‡ç¨‹åºï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿï¼ŒJackæ“ä½œç³»ç»Ÿå®Œå…¨æ²¡æœ‰èµ·åˆ°ç®¡ç†ç¨‹åºçš„ä½œç”¨ã€‚ä½†è¿™ä¸å¦¨ç¢æˆ‘ä»¬ä»ä¸­çª¥åˆ°æ“ä½œç³»ç»Ÿä¸­çš„ä¸€äº›åº•å±‚æ“ä½œçš„å·¥ä½œåŸç†ï¼ˆä¸»è¦æ˜¯å†…å­˜ç®¡ç†å’ŒI/0ç®¡ç†ï¼‰ã€‚</p>

<p>æˆ‘ä»¬ä¹Ÿå®Œå…¨å¯ä»¥å¯¹å®ƒè¿›è¡Œæ‰©å±•ï¼Œä¾‹å¦‚å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸­é›†æˆè¿›100ä¸ªå°æ¸¸æˆï¼Œå¯åŠ¨ååœ¨å±å¹•ä¸Šå±•ç¤ºæ‰€æœ‰æ¸¸æˆçš„å›¾æ ‡ï¼Œç”¨æˆ·é€‰æ‹©æ¸¸æˆåï¼Œæ“ä½œç³»ç»Ÿåˆ‡æ¢åˆ°ç›¸åº”çš„æ¸¸æˆç¨‹åºæ‰§è¡Œã€‚è¿™æ ·æˆ‘ä»¬å°±æŠŠHackå˜æˆäº†ä¸€ä¸ªå°éœ¸ç‹æ¸¸æˆæœºğŸ˜…ã€‚</p>

<p>æœ¬ç¯‡å®Œæ•´å®ç°æ”¾åœ¨äº†:<a href="https://github.com/guosainpu/Nand2Tetris">github</a></p>


                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2020/02/25/%E5%AE%9E%E7%8E%B0%E7%BC%96%E8%AF%91%E5%99%A8/" data-toggle="tooltip" data-placement="top" title="ä»0åˆ°1æ„å»ºè®¡ç®—æœº(9/12)--å®ç°ç¼–è¯‘å™¨">
                        Previous<br>
                        <span>ä»0åˆ°1æ„å»ºè®¡ç®—æœº(9/12)--å®ç°ç¼–è¯‘å™¨</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2020/03/21/%E5%B0%8F%E6%B8%B8%E6%88%8F/" data-toggle="tooltip" data-placement="top" title="ä»0åˆ°1æ„å»ºè®¡ç®—æœº(11/12)--åœ¨Hackä¸Šè¿è¡Œå°æ¸¸æˆ">
                        Next<br>
                        <span>ä»0åˆ°1æ„å»ºè®¡ç®—æœº(11/12)--åœ¨Hackä¸Šè¿è¡Œå°æ¸¸æˆ</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                <!---->
                <!-- disqus è¯„è®ºæ¡† start -->
                <!--<div class="comment">-->
                <!--    <div id="disqus_thread" class="disqus-thread"></div>-->
                <!--</div>-->
                <!-- disqus è¯„è®ºæ¡† end -->
                <!---->

                <!---->
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0004" 
                    href="/archive/?tag=%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80"
                    title="è®¡ç®—æœºåŸºç¡€"
                    rel="18">è®¡ç®—æœºåŸºç¡€</a>
        
                <a data-sort="0010" 
                    href="/archive/?tag=%E4%BB%8E0%E5%88%B01%E6%9E%84%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%BA"
                    title="ä»0åˆ°1æ„å»ºè®¡ç®—æœº"
                    rel="12">ä»0åˆ°1æ„å»ºè®¡ç®—æœº</a>
        
                <a data-sort="0019" 
                    href="/archive/?tag=%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80"
                    title="æ±‡ç¼–è¯­è¨€"
                    rel="3">æ±‡ç¼–è¯­è¨€</a>
        
                <a data-sort="0019" 
                    href="/archive/?tag=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A1%AC%E4%BB%B6%E4%BD%93%E7%B3%BB"
                    title="è®¡ç®—æœºç¡¬ä»¶ä½“ç³»"
                    rel="3">è®¡ç®—æœºç¡¬ä»¶ä½“ç³»</a>
        
                <a data-sort="0020" 
                    href="/archive/?tag=%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80"
                    title="æ•°å­¦åŸºç¡€"
                    rel="2">æ•°å­¦åŸºç¡€</a>
        
                <a data-sort="0020" 
                    href="/archive/?tag=iOS"
                    title="iOS"
                    rel="2">iOS</a>
    </div>
</section>


                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->






<!-- disqus å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "hux";
    var disqus_identifier = "/2020/02/29/ç®€å•çš„æ“ä½œç³»ç»Ÿ";
    var disqus_url = "http://localhost:4000/2020/02/29/%E7%AE%80%E5%8D%95%E7%9A%84%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus å…¬å…±JSä»£ç  end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>

</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-49627206-1';
    var _gaDomain = 'huangxuan.me';

    // Originial
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
