<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="">
    <meta name="keywords"  content="">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="从0到1构建计算机(11/12)--在Hack上运行小游戏 - 一只草履虫">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="经过了前面10章漫长的旅程，我们终于要达成我们的目标了：在一个完全由自己实现的计算机平台上运行一个小游戏。这个小游戏要经过编写、编译、转换虚拟机字节码、汇编、生成机器代码等步骤，最终运行在自己搭建的虚拟计算机上。在游戏的运行过程中，每一条指令都是我们亲手编写，每一个细节我们都了如指掌，是我们完完全全地创造了它（虽然需要基于一个硬件虚拟机），这确实是一件非常有意思的事情。
">
    
    <meta property="article:published_time" content="2020-03-21T00:00:00Z">
    
    
    <meta property="article:author" content="guosai">
    
    
    <meta property="article:tag" content="计算机基础">
    
    <meta property="article:tag" content="从0到1构建计算机">
    
    
    <meta property="og:image" content="http://localhost:4000/img/avatar-hux-ny.jpg">
    <meta property="og:url" content="http://localhost:4000/2020/03/21/%E5%B0%8F%E6%B8%B8%E6%88%8F/">
    <meta property="og:site_name" content="一只草履虫">
    
    <title>从0到1构建计算机(11/12)--在Hack上运行小游戏 - 一只草履虫</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2020/03/21/%E5%B0%8F%E6%B8%B8%E6%88%8F/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">一只草履虫</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80" title="计算机基础">计算机基础</a>
                        
                        <a class="tag" href="/archive/?tag=%E4%BB%8E0%E5%88%B01%E6%9E%84%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%BA" title="从0到1构建计算机">从0到1构建计算机</a>
                        
                    </div>
                    <h1>从0到1构建计算机(11/12)--在Hack上运行小游戏</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by guosai on March 21, 2020</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<p>经过了前面10章漫长的旅程，我们终于要达成我们的目标了：<strong>在一个完全由自己实现的计算机平台上运行一个小游戏</strong>。这个小游戏要经过编写、编译、转换虚拟机字节码、汇编、生成机器代码等步骤，最终运行在自己搭建的虚拟计算机上。在游戏的运行过程中，每一条指令都是我们亲手编写，每一个细节我们都了如指掌，是我们完完全全地创造了它（虽然需要基于一个硬件虚拟机），这确实是一件非常有意思的事情。</p>

<h3 id="骑手快跑">骑手快跑</h3>

<p>我这里编写了一个非常简单的小游戏：骑手快跑。在屏幕上会位置随机地出现<strong>食物</strong>和<strong>房子</strong>，我们扮演骑手，通过上下左右键控制骑手的行动。骑手需要先取到食物装到车上，然后运送到房子处并领取奖励金，完成配送后骑手又可以继续配送下一单，当奖励金达到一定数额后游戏通关🙄。</p>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1tl5zrv9j30tc0gga9v.jpg" width="500" /></center>
<center><figcaption>骑手取货中</figcaption></center>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1tn7ycv5j30tg0gkglf.jpg" width="500" /></center>
<center><figcaption>骑手取到货</figcaption></center>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1tplj00dj30tg0gsglf.jpg" width="500" /></center>
<center><figcaption>骑手配送中</figcaption></center>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1tv6zcbrj30tg0guglf.jpg" width="500" /></center>
<center><figcaption>配送下一单</figcaption></center>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1to4ylhsj30tc0giq2r.jpg" width="500" /></center>
<center><figcaption>奖励金达标，通关</figcaption></center>

<h3 id="实现">实现</h3>

<p>main() 先创建游戏实例，然后运行游戏，游戏结束后调用 dispose() 回收内存</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

    <span class="n">function</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="nc">RunnerGame</span> <span class="n">game</span><span class="o">;</span>
        <span class="k">do</span> <span class="nc">RunnerGame</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
        <span class="n">let</span> <span class="n">game</span> <span class="o">=</span> <span class="nc">RunnerGame</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>

        <span class="k">do</span> <span class="n">game</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
        <span class="k">do</span> <span class="n">game</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>

        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>RunnerGame类是游戏的核心控制类。负责创建骑手、食物、房子等对象；然后监听用户键盘输入、控制游戏逻辑、调整游戏状态、控制屏幕刷新。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">RunnerGame</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="nc">RunnerGame</span> <span class="n">instance</span><span class="o">;</span>    <span class="c1">// 游戏单例</span>

    <span class="n">field</span>  <span class="nc">Runner</span>     <span class="n">runner</span><span class="o">;</span>             <span class="c1">// 骑手</span>
    <span class="n">field</span>  <span class="nc">Food</span>       <span class="n">food</span><span class="o">;</span>               <span class="c1">// 食物</span>
    <span class="n">field</span>  <span class="nc">House</span>      <span class="n">house</span><span class="o">;</span>              <span class="c1">// 配送地点</span>
    
    <span class="n">field</span>  <span class="kt">int</span>        <span class="n">runnerX</span><span class="o">,</span> <span class="n">runnerY</span><span class="o">;</span>   <span class="c1">// 骑手当前位置</span>
    <span class="n">field</span>  <span class="kt">int</span>        <span class="n">foodX</span><span class="o">,</span> <span class="n">foodY</span><span class="o">;</span>       <span class="c1">// 食物当前位置</span>
    <span class="n">field</span>  <span class="kt">int</span>        <span class="n">houseX</span><span class="o">,</span> <span class="n">houseY</span><span class="o">;</span>     <span class="c1">// 房屋当前位置</span>
    <span class="n">field</span>  <span class="kt">boolean</span>    <span class="n">picked</span><span class="o">;</span>             <span class="c1">// 是否取到货</span>
    <span class="n">field</span>  <span class="kt">int</span>        <span class="n">score</span><span class="o">;</span>              <span class="c1">// 挣到的钱</span>

    <span class="n">field</span>  <span class="kt">boolean</span>    <span class="n">exit</span><span class="o">;</span>               <span class="c1">// 游戏结束</span>

    <span class="n">constructor</span> <span class="nc">RunnerGame</span> <span class="nf">new</span><span class="o">()</span> <span class="o">{</span>
	    <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">clearScreen</span><span class="o">();</span>

	    <span class="n">let</span> <span class="n">runnerX</span> <span class="o">=</span> <span class="mi">230</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">runnerY</span> <span class="o">=</span> <span class="mi">120</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">foodX</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">foodY</span> <span class="o">=</span> <span class="mi">200</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">houseX</span> <span class="o">=</span> <span class="mi">400</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">houseY</span> <span class="o">=</span> <span class="mi">50</span><span class="o">;</span>

	    <span class="n">let</span> <span class="n">runner</span> <span class="o">=</span> <span class="nc">Runner</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="n">runnerX</span><span class="o">,</span> <span class="n">runnerY</span><span class="o">);</span>
	    <span class="n">let</span> <span class="n">house</span> <span class="o">=</span> <span class="nc">House</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="n">houseX</span><span class="o">,</span> <span class="n">houseY</span><span class="o">);</span>
	    <span class="n">let</span> <span class="n">food</span> <span class="o">=</span> <span class="nc">Food</span><span class="o">.</span><span class="na">new</span><span class="o">(</span><span class="n">foodX</span><span class="o">,</span> <span class="n">foodY</span><span class="o">);</span>

	    <span class="n">let</span> <span class="n">picked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
	    <span class="n">let</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

	    <span class="c1">// 底部分数分数记录区</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawRectangle</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">238</span><span class="o">,</span> <span class="mi">511</span><span class="o">,</span> <span class="mi">240</span><span class="o">);</span>
	    <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">moveCursor</span><span class="o">(</span><span class="mi">22</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>
	    <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="s">"money: 0"</span><span class="o">);</span>
	
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="n">runner</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
	    <span class="k">do</span> <span class="n">food</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
	    <span class="k">do</span> <span class="n">house</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="k">do</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">deAlloc</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>

        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">function</span> <span class="kt">void</span> <span class="nf">newInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">instance</span> <span class="o">=</span> <span class="nc">RunnerGame</span><span class="o">.</span><span class="na">new</span><span class="o">();</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="n">function</span> <span class="nc">RunnerGame</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 开始游戏。用键盘控制骑手位置，先取货，再送货，然后获得奖励</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="kt">char</span> <span class="n">key</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(~</span><span class="n">exit</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// 等待按下按键</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">key</span> <span class="o">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(~</span><span class="n">exit</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">let</span> <span class="n">key</span> <span class="o">=</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">keyPressed</span><span class="o">();</span>
                <span class="k">do</span> <span class="nc">Sys</span><span class="o">.</span><span class="na">wait</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="k">do</span> <span class="nf">moveRunner</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

            <span class="c1">// 等待按键松开</span>
            <span class="k">while</span> <span class="o">((~(</span><span class="n">key</span> <span class="o">=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">&amp;</span> <span class="o">(~</span><span class="n">exit</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">let</span> <span class="n">key</span> <span class="o">=</span> <span class="nc">Keyboard</span><span class="o">.</span><span class="na">keyPressed</span><span class="o">();</span>
                <span class="k">do</span> <span class="nc">Sys</span><span class="o">.</span><span class="na">wait</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="k">do</span> <span class="nf">updateStatus</span><span class="o">();</span>
            <span class="k">do</span> <span class="nf">reDraw</span><span class="o">();</span>
        <span class="o">}</span>

	    <span class="k">if</span> <span class="o">(</span><span class="n">exit</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">moveCursor</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">23</span><span class="o">);</span>
            <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="s">"Congratulations!"</span><span class="o">);</span>
	    <span class="o">}</span>
            
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">moveRunner</span><span class="o">(</span><span class="kt">int</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 左 = 130，上 = 131，右 = 132，下 = 133</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span> <span class="mi">130</span><span class="o">)</span> <span class="o">{</span> 
        	<span class="n">let</span> <span class="n">runnerX</span> <span class="o">=</span> <span class="n">runnerX</span> <span class="o">-</span> <span class="mi">20</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span> <span class="mi">131</span><span class="o">)</span> <span class="o">{</span> 
            	<span class="n">let</span> <span class="n">runnerY</span> <span class="o">=</span> <span class="n">runnerY</span> <span class="o">-</span> <span class="mi">20</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span> <span class="mi">132</span><span class="o">)</span> <span class="o">{</span>
                	<span class="n">let</span> <span class="n">runnerX</span> <span class="o">=</span> <span class="n">runnerX</span> <span class="o">+</span> <span class="mi">20</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                	<span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">=</span> <span class="mi">133</span><span class="o">)</span> <span class="o">{</span>
                		<span class="n">let</span> <span class="n">runnerY</span> <span class="o">=</span> <span class="n">runnerY</span> <span class="o">+</span> <span class="mi">20</span><span class="o">;</span>
                	<span class="o">}</span>
                <span class="o">}</span>
	        <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// 防止越界</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">runnerX</span> <span class="o">&gt;</span> <span class="mi">490</span><span class="o">)</span> <span class="o">{</span>
        	<span class="n">let</span> <span class="n">runnerX</span> <span class="o">=</span> <span class="mi">490</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">runnerX</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        	<span class="n">let</span> <span class="n">runnerX</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">runnerY</span> <span class="o">&gt;</span> <span class="mi">236</span><span class="o">)</span> <span class="o">{</span>
        	<span class="n">let</span> <span class="n">runnerY</span> <span class="o">=</span> <span class="mi">236</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">runnerY</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        	<span class="n">let</span> <span class="n">runnerY</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">do</span> <span class="n">runner</span><span class="o">.</span><span class="na">moveTo</span><span class="o">(</span><span class="n">runnerX</span><span class="o">,</span> <span class="n">runnerY</span><span class="o">);</span>

        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">updateStatus</span><span class="o">()</span> <span class="o">{</span>
    	<span class="c1">// 取到食物</span>
    	<span class="k">if</span> <span class="o">((</span><span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">foodX</span> <span class="o">-</span> <span class="n">runnerX</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">foodY</span> <span class="o">-</span> <span class="n">runnerY</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">))</span> <span class="o">{</span>
    		<span class="n">let</span> <span class="n">picked</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    		<span class="k">do</span> <span class="n">runner</span><span class="o">.</span><span class="na">setPicked</span><span class="o">(</span><span class="n">picked</span><span class="o">);</span>
    	<span class="o">}</span>

    	<span class="c1">// 送到食物</span>
    	<span class="k">if</span> <span class="o">(</span><span class="n">picked</span> <span class="o">&amp;</span> <span class="o">((</span><span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">houseX</span> <span class="o">-</span> <span class="n">runnerX</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">houseY</span> <span class="o">-</span> <span class="n">runnerY</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">)))</span> <span class="o">{</span>
    		<span class="n">let</span> <span class="n">score</span> <span class="o">=</span> <span class="n">score</span> <span class="o">+</span> <span class="mi">30</span><span class="o">;</span>
    		<span class="k">if</span> <span class="o">(</span><span class="n">score</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
    			<span class="n">let</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    		<span class="o">}</span>

    		<span class="n">let</span> <span class="n">picked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    		<span class="k">do</span> <span class="n">runner</span><span class="o">.</span><span class="na">setPicked</span><span class="o">(</span><span class="n">picked</span><span class="o">);</span>

    		<span class="k">do</span> <span class="nf">newRound</span><span class="o">();</span>
    	<span class="o">}</span>

    	<span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 完成一次配送，更新食物和房屋的位置</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">newRound</span><span class="o">()</span> <span class="o">{</span>
    	<span class="c1">// 更新位置</span>
    	<span class="n">let</span> <span class="n">foodX</span> <span class="o">=</span> <span class="n">mod</span><span class="o">(</span><span class="n">foodX</span> <span class="o">+</span> <span class="n">houseX</span> <span class="o">,</span> <span class="mi">490</span><span class="o">);</span>
    	<span class="n">let</span> <span class="n">foodY</span> <span class="o">=</span> <span class="n">mod</span><span class="o">(</span><span class="n">foodY</span> <span class="o">+</span> <span class="n">houseY</span> <span class="o">,</span> <span class="mi">236</span><span class="o">);</span>
    	<span class="n">let</span> <span class="n">houseX</span> <span class="o">=</span> <span class="n">mod</span><span class="o">(</span><span class="n">foodY</span> <span class="o">+</span> <span class="n">houseX</span> <span class="o">,</span> <span class="mi">490</span><span class="o">);</span>
    	<span class="n">let</span> <span class="n">houseY</span> <span class="o">=</span> <span class="n">mod</span><span class="o">(</span><span class="n">houseX</span> <span class="o">+</span> <span class="n">foodY</span> <span class="o">,</span> <span class="mi">236</span><span class="o">);</span>

    	<span class="k">do</span> <span class="n">food</span><span class="o">.</span><span class="na">moveTo</span><span class="o">(</span><span class="n">foodX</span><span class="o">,</span> <span class="n">foodY</span><span class="o">);</span>
    	<span class="k">do</span> <span class="n">house</span><span class="o">.</span><span class="na">moveTo</span><span class="o">(</span><span class="n">houseX</span><span class="o">,</span> <span class="n">houseY</span><span class="o">);</span>

    	<span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 重新绘制</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">reDraw</span><span class="o">()</span> <span class="o">{</span>
    	<span class="k">do</span> <span class="n">runner</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
    	<span class="k">do</span> <span class="n">house</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
    	<span class="k">if</span> <span class="o">(</span><span class="n">picked</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">do</span> <span class="n">food</span><span class="o">.</span><span class="na">hide</span><span class="o">();</span>    		
    	<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">do</span> <span class="n">food</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>   		
    	<span class="o">}</span>

    	<span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">moveCursor</span><span class="o">(</span><span class="mi">22</span><span class="o">,</span><span class="mi">7</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Output</span><span class="o">.</span><span class="na">printInt</span><span class="o">(</span><span class="n">score</span><span class="o">);</span>

        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 补充一个取模的方法</span>
    <span class="n">method</span> <span class="kt">int</span> <span class="nf">mod</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="kt">int</span> <span class="n">q</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">q</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="o">(</span><span class="n">q</span><span class="o">*</span><span class="n">y</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Runner，House，Food类负责表示个字的对象，维护对象位置信息，状态信息，并负责绘制自己的图形。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Runner</span> <span class="o">{</span>

    <span class="n">field</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>           <span class="c1">// 骑手位置</span>
    <span class="n">field</span> <span class="kt">int</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">;</span>  <span class="c1">// 骑手宽高 20*20</span>
    <span class="n">field</span> <span class="n">boolen</span> <span class="n">picked</span><span class="o">;</span>          <span class="c1">// 是否已取货</span>

    <span class="c1">// 新创建一个骑手</span>
    <span class="n">constructor</span> <span class="nc">Runner</span> <span class="nf">new</span><span class="o">(</span><span class="kt">int</span> <span class="nc">Ax</span><span class="o">,</span> <span class="kt">int</span> <span class="nc">Ay</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Ax</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Ay</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">picked</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="k">do</span> <span class="nf">show</span><span class="o">();</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Memory</span><span class="o">.</span><span class="na">deAlloc</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 在screen上展示骑手</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">show</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="k">do</span> <span class="nf">draw</span><span class="o">();</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 抹掉当前在screen上展示的骑手</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">hide</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="k">do</span> <span class="nf">draw</span><span class="o">();</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** 绘制房屋 */</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawRectangle</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">9</span><span class="o">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">19</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">10</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawCircle</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">,</span>  <span class="n">y</span> <span class="o">+</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawCircle</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">15</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">15</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">9</span><span class="o">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">15</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">);</span>
        <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">19</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">picked</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">do</span> <span class="nc">Screen</span><span class="o">.</span><span class="na">drawCircle</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">setPicked</span><span class="o">(</span><span class="kt">boolean</span> <span class="nc">Apicked</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">picked</span> <span class="o">=</span> <span class="nc">Apicked</span><span class="o">;</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">moveTo</span><span class="o">(</span><span class="kt">int</span> <span class="nc">Ax</span><span class="o">,</span> <span class="kt">int</span> <span class="nc">Ay</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">do</span> <span class="nf">hide</span><span class="o">();</span>  <span class="c1">//先抹掉当前骑手</span>

        <span class="n">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Ax</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Ay</span><span class="o">;</span>
        <span class="k">do</span> <span class="nf">draw</span><span class="o">();</span>   <span class="c1">// 重新画骑手</span>

        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Food</span> <span class="o">{</span>

    <span class="n">field</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>           <span class="c1">// 食物位置</span>
    <span class="n">field</span> <span class="kt">int</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">;</span>  <span class="c1">// 食物宽高 15*15</span>

    <span class="c1">// 新创建一个食物</span>
    <span class="n">constructor</span> <span class="nc">Food</span> <span class="nf">new</span><span class="o">(</span><span class="kt">int</span> <span class="nc">Ax</span><span class="o">,</span> <span class="kt">int</span> <span class="nc">Ay</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Ax</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Ay</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">15</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">15</span><span class="o">;</span>

        <span class="k">do</span> <span class="nf">show</span><span class="o">();</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="c1">// 在screen上展示食物</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">show</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="c1">// 抹掉当前在screen上展示的食物</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">hide</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="cm">/** 绘制食物 */</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">moveTo</span><span class="o">(</span><span class="kt">int</span> <span class="nc">Ax</span><span class="o">,</span> <span class="kt">int</span> <span class="nc">Ay</span><span class="o">)</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">House</span> <span class="o">{</span>

    <span class="n">field</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>           <span class="c1">// 房屋位置</span>
    <span class="n">field</span> <span class="kt">int</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">;</span>  <span class="c1">// 房屋宽高 20*20</span>

    <span class="c1">// 新创建一个房屋</span>
    <span class="n">constructor</span> <span class="nc">House</span> <span class="nf">new</span><span class="o">(</span><span class="kt">int</span> <span class="nc">Ax</span><span class="o">,</span> <span class="kt">int</span> <span class="nc">Ay</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Ax</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Ay</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
        <span class="n">let</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>

        <span class="k">do</span> <span class="nf">show</span><span class="o">();</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="c1">// 在screen上展示房屋</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">show</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="c1">// 抹掉当前在screen上展示的房屋</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">hide</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="cm">/** 绘制房屋 */</span>
    <span class="n">method</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>

    <span class="n">method</span> <span class="kt">void</span> <span class="nf">moveTo</span><span class="o">(</span><span class="kt">int</span> <span class="nc">Ax</span><span class="o">,</span> <span class="kt">int</span> <span class="nc">Ay</span><span class="o">)</span> <span class="o">{</span>
    	<span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="广告">广告</h3>

<center><img src="https://tva1.sinaimg.cn/large/00831rSTly1gd1u99ll6aj31j60qcx0l.jpg" width="800" /></center>
<center><figcaption><h2>当美团骑手，做有为青年</h2></figcaption></center>


                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2020/02/29/%E7%AE%80%E5%8D%95%E7%9A%84%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" data-toggle="tooltip" data-placement="top" title="从0到1构建计算机(10/12)--简单的操作系统">
                        Previous<br>
                        <span>从0到1构建计算机(10/12)--简单的操作系统</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2020/03/22/%E6%94%B6%E8%8E%B7%E5%92%8C%E6%80%BB%E7%BB%93/" data-toggle="tooltip" data-placement="top" title="从0到1构建计算机(12/12)--收获和总结">
                        Next<br>
                        <span>从0到1构建计算机(12/12)--收获和总结</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                <!---->
                <!-- disqus 评论框 start -->
                <!--<div class="comment">-->
                <!--    <div id="disqus_thread" class="disqus-thread"></div>-->
                <!--</div>-->
                <!-- disqus 评论框 end -->
                <!---->

                <!---->
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0005" 
                    href="/archive/?tag=%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80"
                    title="计算机基础"
                    rel="20">计算机基础</a>
        
                <a data-sort="0013" 
                    href="/archive/?tag=%E4%BB%8E0%E5%88%B01%E6%9E%84%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%BA"
                    title="从0到1构建计算机"
                    rel="12">从0到1构建计算机</a>
        
                <a data-sort="0022" 
                    href="/archive/?tag=%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"
                    title="操作系统"
                    rel="3">操作系统</a>
        
                <a data-sort="0022" 
                    href="/archive/?tag=%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80"
                    title="汇编语言"
                    rel="3">汇编语言</a>
        
                <a data-sort="0022" 
                    href="/archive/?tag=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A1%AC%E4%BB%B6%E4%BD%93%E7%B3%BB"
                    title="计算机硬件体系"
                    rel="3">计算机硬件体系</a>
        
                <a data-sort="0023" 
                    href="/archive/?tag=%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80"
                    title="数学基础"
                    rel="2">数学基础</a>
        
                <a data-sort="0023" 
                    href="/archive/?tag=OS%E5%86%85%E6%A0%B8"
                    title="OS内核"
                    rel="2">OS内核</a>
        
                <a data-sort="0023" 
                    href="/archive/?tag=iOS"
                    title="iOS"
                    rel="2">iOS</a>
    </div>
</section>


                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->






<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "hux";
    var disqus_identifier = "/2020/03/21/小游戏";
    var disqus_url = "http://localhost:4000/2020/03/21/%E5%B0%8F%E6%B8%B8%E6%88%8F/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>

</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-49627206-1';
    var _gaDomain = 'huangxuan.me';

    // Originial
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
